<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>GestorDesportivo.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Solucao1</a> &gt; <a href="index.source.html" class="el_package">org.example</a> &gt; <span class="el_source">GestorDesportivo.java</span></div><h1>GestorDesportivo.java</h1><pre class="source lang-java linenums">package org.example;
import java.util.*;
import java.io.*;
import java.time.LocalDate;
import java.time.*;
import java.util.function.BiFunction;
import java.util.function.Function;
import java.util.function.Predicate;

/**
 * Classe GestorDesportivo, que corresponde à lógica de negócio da aplicação / model
 *
 * @author Grupo10
 * @version 09/05/24
 * Notas versão :
 */
public class GestorDesportivo implements Serializable
{
    private LocalDate dataAtual;
    private Map&lt;Integer, Utilizador&gt; utilizadores;
    private Map&lt;Integer, Utilizador&gt; utilizadoresNumPeriodo;
    private Map&lt;Integer, Atividade&gt; atividades;
    private Map&lt;Integer, PlanoTreino&gt; planos;
    
<span class="nc" id="L25">    public GestorDesportivo(){</span>
<span class="nc" id="L26">        this.dataAtual = LocalDate.now();</span>
<span class="nc" id="L27">        this.utilizadores = new HashMap&lt;Integer, Utilizador&gt;();</span>
<span class="nc" id="L28">        this.utilizadoresNumPeriodo = new HashMap&lt;Integer, Utilizador&gt;();</span>
<span class="nc" id="L29">        this.atividades = new HashMap&lt;Integer,Atividade&gt;();</span>
<span class="nc" id="L30">        this.planos = new HashMap&lt;Integer,PlanoTreino&gt;();</span>
<span class="nc" id="L31">    }</span>
    
    public void guardaEstado(String nome) throws IOException {
<span class="nc" id="L34">        FileOutputStream file = new FileOutputStream(nome);</span>
<span class="nc" id="L35">        ObjectOutputStream oos = new ObjectOutputStream(file);</span>
<span class="nc" id="L36">        oos.writeObject(this);</span>
<span class="nc" id="L37">        oos.flush();</span>
<span class="nc" id="L38">        oos.close();</span>
<span class="nc" id="L39">    } </span>
    
    public GestorDesportivo carregaEstado(String nome) throws ClassNotFoundException, IOException {
<span class="nc" id="L42">        FileInputStream file = new FileInputStream(nome);</span>
<span class="nc" id="L43">        ObjectInputStream ois = new ObjectInputStream(file);</span>
<span class="nc" id="L44">        GestorDesportivo model = (GestorDesportivo) ois.readObject();</span>
<span class="nc" id="L45">        ois.close();</span>
<span class="nc" id="L46">        return (model);</span>
    }
    
    public void estadoAtualizado () {
<span class="nc bnc" id="L50" title="All 2 branches missed.">        if (!this.utilizadores.isEmpty()) {</span>
<span class="nc" id="L51">            int maiorChaveU = Collections.max(this.utilizadores.keySet());</span>
<span class="nc" id="L52">            utilizadores.get(1).setProximoCodigo(maiorChaveU + 1);</span>
        }
<span class="nc bnc" id="L54" title="All 2 branches missed.">        if (!this.atividades.isEmpty()) {</span>
<span class="nc" id="L55">            int maiorChaveA = Collections.max(this.atividades.keySet());</span>
<span class="nc" id="L56">            atividades.get(1).setProximoCodigo(maiorChaveA + 1);</span>
        }
<span class="nc bnc" id="L58" title="All 2 branches missed.">        if (!this.planos.isEmpty()) {</span>
<span class="nc" id="L59">            int maiorChaveP = Collections.max(this.planos.keySet());</span>
<span class="nc" id="L60">            planos.get(1).setProximoCodigo(maiorChaveP + 1);</span>
        }
<span class="nc" id="L62">    }</span>

    public void atualizaInfo (LocalDate datafim) {
<span class="nc" id="L65">        this.utilizadoresNumPeriodo = new HashMap&lt;Integer, Utilizador&gt;();</span>
<span class="nc" id="L66">        List&lt;Utilizador&gt; utilizadores = new ArrayList&lt;Utilizador&gt;();</span>
<span class="nc bnc" id="L67" title="All 2 branches missed.">        for (Utilizador u : this.utilizadores.values()) {</span>
<span class="nc" id="L68">            Utilizador value = (Utilizador) u.utilizadorNumPeriodo(LocalDate.MIN,datafim);</span>
<span class="nc" id="L69">            int chave = value.getCodUtilizador();</span>
<span class="nc" id="L70">            this.utilizadoresNumPeriodo.put(chave,value);</span>
<span class="nc" id="L71">        }</span>
<span class="nc" id="L72">    }</span>
    
        /**
     * Requisitos 3.2
     * ponto 6
     */
    public PlanoTreino planoTreinoMaisCalorias (LocalDate f) {
<span class="nc" id="L79">        double maxCal = 0;</span>
<span class="nc" id="L80">        PlanoTreino b = null;</span>
<span class="nc bnc" id="L81" title="All 2 branches missed.">        for (Utilizador u : this.utilizadoresNumPeriodo.values()) {</span>
<span class="nc" id="L82">            PlanoTreino a = u.planoTreinoMaisCalorias(LocalDate.MIN, f);</span>
<span class="nc bnc" id="L83" title="All 2 branches missed.">            if (a.caloriasDispendidas(u) &gt;= maxCal) {</span>
<span class="nc" id="L84">                b = a;</span>
<span class="nc" id="L85">                maxCal = a.caloriasDispendidas(u);</span>
            }
<span class="nc" id="L87">        }</span>
<span class="nc" id="L88">        return b;</span>
    }
    
    /**
     * Requisitos 3.2
     * ponto 3
     */
    public String atividadeMaisRealizada () {
<span class="nc" id="L96">        List&lt;Atividade&gt; atividades = new ArrayList&lt;Atividade&gt;();</span>
<span class="nc" id="L97">        Predicate&lt;Atividade&gt; p = atividade -&gt; true;</span>
<span class="nc" id="L98">        this.utilizadoresNumPeriodo.values().forEach(u -&gt; atividades.addAll(u.atividadesNumPeriodoQueRespeitamP(LocalDate.MIN, LocalDate.MAX, p)));</span>
        
<span class="nc" id="L100">        Map&lt;String,Integer&gt; tipoAtividadeQuantidade = new HashMap&lt;&gt;();</span>
        
<span class="nc bnc" id="L102" title="All 2 branches missed.">        for (Atividade atividade : atividades) {</span>
<span class="nc" id="L103">            String tipo = atividade.getClass().getSimpleName();</span>
<span class="nc" id="L104">            tipoAtividadeQuantidade.put(tipo, tipoAtividadeQuantidade.getOrDefault(tipo, 0) + 1);</span>
<span class="nc" id="L105">        }</span>
        
<span class="nc" id="L107">        String atividadeMaisRealizada = null;</span>
<span class="nc" id="L108">        int contagemMaisFrequente = 0;</span>
        
<span class="nc bnc" id="L110" title="All 2 branches missed.">        for (Map.Entry&lt;String, Integer&gt; entry : tipoAtividadeQuantidade.entrySet()) {</span>
<span class="nc bnc" id="L111" title="All 2 branches missed.">            if (entry.getValue() &gt;= contagemMaisFrequente) {</span>
<span class="nc" id="L112">                atividadeMaisRealizada = entry.getKey();</span>
<span class="nc" id="L113">                contagemMaisFrequente = entry.getValue();</span>
            }
<span class="nc" id="L115">        }</span>

<span class="nc" id="L117">        return atividadeMaisRealizada;</span>
    }
    
    /** 
     * Utilizador com mais atividades
     * Requisito 3.2
     * ponto 2
    */
    public Utilizador maisAtividades (LocalDate dataInicial, LocalDate dataFinal) {
<span class="nc bnc" id="L126" title="All 2 branches missed.">         return (Utilizador) this.utilizadoresNumPeriodo.values().stream().reduce((u1, u2) -&gt; u1.numeroAtividades(dataInicial,dataFinal) &gt; u2.numeroAtividades(dataInicial,dataFinal) ? u1 : u2).orElse(null).clone();</span>
    }
    
    /**
     * Método maisCaloriasGastas, que calcula qual utilizador dispendeu mais calorias num período ou desde sempre
     * Requisito 3.2
     * ponto 1
    */
    public Utilizador maisCaloriasGastas(LocalDate dataInicial, LocalDate dataFinal) {
<span class="nc bnc" id="L135" title="All 2 branches missed.">        return (Utilizador) this.utilizadoresNumPeriodo.values().stream().reduce((u1, u2) -&gt; u1.totalCaloriasDispendidas(dataInicial,dataFinal) &gt; u2.totalCaloriasDispendidas(dataInicial,dataFinal) ? u1 : u2).orElse(null).clone();</span>
    }
    
    
    public int addUtilizador(String nome, String morada, String email, int freqCardiaca, int peso, int altura, LocalDate dataNascimento, char genero, int tipo){
         Utilizador novoUtilizador;
<span class="nc bnc" id="L141" title="All 2 branches missed.">         if(tipo==1){</span>
<span class="nc" id="L142">             novoUtilizador = new UtilizadorAmador(nome, morada, email, freqCardiaca, peso, altura, dataNascimento, genero);</span>
         }
<span class="nc bnc" id="L144" title="All 2 branches missed.">         else if(tipo==3){</span>
<span class="nc" id="L145">             novoUtilizador = new UtilizadorProfissional(nome, morada, email, freqCardiaca, peso, altura, dataNascimento, genero);</span>
         }
         else{
<span class="nc" id="L148">             novoUtilizador = new UtilizadorPraticanteOcasional(nome, morada, email, freqCardiaca, peso, altura, dataNascimento, genero);</span>
         }
<span class="nc" id="L150">         this.utilizadores.put(novoUtilizador.getCodUtilizador(), novoUtilizador);</span>
<span class="nc" id="L151">         return novoUtilizador.getCodUtilizador();</span>
    }
    
    public String showUtilizador(int codigo) {
<span class="nc bnc" id="L155" title="All 2 branches missed.">        if (this.utilizadores.containsKey(codigo)) {</span>
<span class="nc" id="L156">            return this.utilizadores.get(codigo).toString();</span>
        } else {
<span class="nc" id="L158">            return &quot;Nao existe utilizador com este codigo\n&quot;;</span>
        }
    }
    
    public String showAtividade(int codigo) {
<span class="nc bnc" id="L163" title="All 2 branches missed.">        if (this.atividades.containsKey(codigo)) {</span>
<span class="nc" id="L164">            return this.atividades.get(codigo).toString();</span>
        } else {
<span class="nc" id="L166">            return &quot;Nao existe atividade com este codigo\n&quot;;</span>
        }
    }
    
    public String showPlanoTreino(int codigo) {
<span class="nc bnc" id="L171" title="All 2 branches missed.">        if (this.planos.containsKey(codigo)) {</span>
<span class="nc" id="L172">            return this.planos.get(codigo).toString();</span>
        } else {
<span class="nc" id="L174">            return &quot;Nao existe plano de treino com este codigo\n&quot;;</span>
        }
    }
    
    public boolean existeUtilizador(int codUtilizador){
<span class="nc" id="L179">        return this.utilizadores.containsKey(codUtilizador);</span>
    }
    
    public boolean existeAtividade(int codAtividade){
<span class="nc" id="L183">        return this.atividades.containsKey(codAtividade);</span>
    }
    
    public boolean existePlano(int codPlano){
<span class="nc" id="L187">        return this.planos.containsKey(codPlano);</span>
    }
    
    public int addAtivDist(LocalDateTime realizacao, LocalTime tempo, int freqCardiaca, double distancia, int tipo){
         Atividade novaAtividade;
<span class="nc bnc" id="L192" title="All 2 branches missed.">         if(tipo==1){</span>
<span class="nc" id="L193">             novaAtividade = new Corrida(realizacao, tempo, freqCardiaca, distancia);</span>
         }
         else{
<span class="nc" id="L196">             novaAtividade = new Ciclismo(realizacao, tempo, freqCardiaca, distancia);</span>
         }
<span class="nc" id="L198">         this.atividades.put(novaAtividade.getCodAtividade(), novaAtividade);</span>
<span class="nc" id="L199">         return novaAtividade.getCodAtividade();</span>
    }
    
    public int addAtivDistAlt(LocalDateTime realizacao, LocalTime tempo, int freqCardiaca, double distancia, double altimetria, int tipo){
         Atividade novaAtividade;
<span class="nc bnc" id="L204" title="All 2 branches missed.">         if(tipo==3){</span>
<span class="nc" id="L205">             novaAtividade = new Trail(realizacao, tempo, freqCardiaca, distancia, altimetria);</span>
         }
         else{
<span class="nc" id="L208">             novaAtividade = new Btt(realizacao, tempo, freqCardiaca, distancia, altimetria);</span>
         }
<span class="nc" id="L210">         this.atividades.put(novaAtividade.getCodAtividade(), novaAtividade);</span>
<span class="nc" id="L211">         return novaAtividade.getCodAtividade();</span>
    }
    
    public int addAtivRep(LocalDateTime realizacao, LocalTime tempo, int freqCardiaca, int repeticoes, int tipo){
         Atividade novaAtividade;
<span class="nc bnc" id="L216" title="All 2 branches missed.">         if(tipo==5){</span>
<span class="nc" id="L217">             novaAtividade = new Flexoes(realizacao, tempo, freqCardiaca, repeticoes);</span>
         }
         else{
<span class="nc" id="L220">             novaAtividade = new Abdominais(realizacao, tempo, freqCardiaca, repeticoes);</span>
         }
<span class="nc" id="L222">         this.atividades.put(novaAtividade.getCodAtividade(), novaAtividade);</span>
<span class="nc" id="L223">         return novaAtividade.getCodAtividade();</span>
    }
    
    public int addAtivRepsPeso(LocalDateTime realizacao, LocalTime tempo, int freqCardiaca, int repeticoes, double peso, int tipo){
         Atividade novaAtividade;
<span class="nc bnc" id="L228" title="All 2 branches missed.">         if(tipo==7){</span>
<span class="nc" id="L229">             novaAtividade = new LegPress(realizacao, tempo, freqCardiaca, repeticoes, peso);</span>
         }
<span class="nc bnc" id="L231" title="All 2 branches missed.">         if(tipo==8){</span>
<span class="nc" id="L232">             novaAtividade = new BenchPress(realizacao, tempo, freqCardiaca, repeticoes, peso);</span>
         }
         else{
<span class="nc" id="L235">             novaAtividade = new BicepCurls(realizacao, tempo, freqCardiaca, repeticoes, peso);</span>
         }
<span class="nc" id="L237">         this.atividades.put(novaAtividade.getCodAtividade(), novaAtividade);</span>
<span class="nc" id="L238">         return novaAtividade.getCodAtividade();</span>
    }
    
    public void registaAtividade(int codUtilizador, int codAtividade){
<span class="nc" id="L242">        Atividade ativ =  this.atividades.get(codAtividade);</span>
<span class="nc" id="L243">        this.utilizadores.get(codUtilizador).addAtividade((Atividade) ativ.clone());</span>
<span class="nc" id="L244">    }</span>
    
    public void addAtivDistPlano(int codPlano, int iteracoes, LocalDateTime realizacao, LocalTime tempo, int freqCardiaca, double distancia, int tipo){
         Atividade novaAtividade;
<span class="nc bnc" id="L248" title="All 2 branches missed.">         if(tipo==1){</span>
<span class="nc" id="L249">             novaAtividade = new Corrida(realizacao, tempo, freqCardiaca, distancia);</span>
         }
         else{
<span class="nc" id="L252">             novaAtividade = new Ciclismo(realizacao, tempo, freqCardiaca, distancia);</span>
         }
<span class="nc" id="L254">         this.planos.get(codPlano).addAtividade(novaAtividade, iteracoes);</span>
<span class="nc" id="L255">    }</span>
    
    public void addAtivDistAltPlano(int codPlano, int iteracoes, LocalDateTime realizacao, LocalTime tempo, int freqCardiaca, double distancia, double altimetria, int tipo){
         Atividade novaAtividade;
<span class="nc bnc" id="L259" title="All 2 branches missed.">         if(tipo==3){</span>
<span class="nc" id="L260">             novaAtividade = new Trail(realizacao, tempo, freqCardiaca, distancia, altimetria);</span>
         }
         else{
<span class="nc" id="L263">             novaAtividade = new Btt(realizacao, tempo, freqCardiaca, distancia, altimetria);</span>
         }
<span class="nc" id="L265">         this.planos.get(codPlano).addAtividade(novaAtividade, iteracoes);</span>
<span class="nc" id="L266">    }</span>
    
    public void addAtivRepPlano(int codPlano, int iteracoes, LocalDateTime realizacao, LocalTime tempo, int freqCardiaca, int repeticoes, int tipo){
         Atividade novaAtividade;
<span class="nc bnc" id="L270" title="All 2 branches missed.">         if(tipo==5){</span>
<span class="nc" id="L271">             novaAtividade = new Flexoes(realizacao, tempo, freqCardiaca, repeticoes);</span>
         }
         else{
<span class="nc" id="L274">             novaAtividade = new Abdominais(realizacao, tempo, freqCardiaca, repeticoes);</span>
         }
<span class="nc" id="L276">         this.planos.get(codPlano).addAtividade(novaAtividade, iteracoes);</span>
<span class="nc" id="L277">    }</span>
    
    public void addAtivRepsPesoPlano(int codPlano, int iteracoes, LocalDateTime realizacao, LocalTime tempo, int freqCardiaca, int repeticoes, double peso, int tipo){
         Atividade novaAtividade;
<span class="nc bnc" id="L281" title="All 2 branches missed.">         if(tipo==7){</span>
<span class="nc" id="L282">             novaAtividade = new LegPress(realizacao, tempo, freqCardiaca, repeticoes, peso);</span>
         }
<span class="nc bnc" id="L284" title="All 2 branches missed.">         if(tipo==8){</span>
<span class="nc" id="L285">             novaAtividade = new BenchPress(realizacao, tempo, freqCardiaca, repeticoes, peso);</span>
         }
         else{
<span class="nc" id="L288">             novaAtividade = new BicepCurls(realizacao, tempo, freqCardiaca, repeticoes, peso);</span>
         }
<span class="nc" id="L290">         this.planos.get(codPlano).addAtividade(novaAtividade, iteracoes);</span>
<span class="nc" id="L291">    }</span>
    
    public void registaPlanoTreino(int codUtilizador, int codPlano){
<span class="nc" id="L294">        PlanoTreino plano =  this.planos.get(codPlano);</span>
<span class="nc" id="L295">        this.utilizadores.get(codUtilizador).addPlanoTreino((PlanoTreino) plano.clone());</span>
<span class="nc" id="L296">    }</span>
    
    public int addPlanoTreino(LocalDate data){
<span class="nc" id="L299">        PlanoTreino plano = new PlanoTreino(data);</span>
<span class="nc" id="L300">        this.planos.put(plano.getCodPlano(), plano);</span>
<span class="nc" id="L301">        return plano.getCodPlano();</span>
    }
    
    public double kmsPercorridos(int codUtilizador, LocalDate dataInicio, LocalDate dataFim){
<span class="nc" id="L305">        return this.utilizadoresNumPeriodo.get(codUtilizador).allKmsDistancia(dataInicio,dataFim);</span>
    }
    
    public double metrosAltimetria(int codUtilizador, LocalDate dataInicio, LocalDate dataFim){
<span class="nc" id="L309">        return this.utilizadoresNumPeriodo.get(codUtilizador).allMetrosAltimetria(dataInicio,dataFim);</span>
    }
    
    public String atividadesExecutadasUtilizador(int codUtilizador){
<span class="nc" id="L313">        StringBuilder sb = new StringBuilder();</span>
<span class="nc bnc" id="L314" title="All 2 branches missed.">        for (Atividade a : this.utilizadoresNumPeriodo.get(codUtilizador).allAtividades(LocalDate.MIN,LocalDate.MAX)){</span>
<span class="nc" id="L315">            sb.append(a.toString());</span>
<span class="nc" id="L316">        }</span>
<span class="nc" id="L317">        return sb.toString();</span>
    }
    
    public String atividadesUtilizador(int codUtilizador){
<span class="nc" id="L321">        StringBuilder sb = new StringBuilder();</span>
<span class="nc bnc" id="L322" title="All 2 branches missed.">        for (Atividade a : this.utilizadores.get(codUtilizador).allAtividades(LocalDate.MIN,LocalDate.MAX)){</span>
<span class="nc" id="L323">            sb.append(a.toString());</span>
<span class="nc" id="L324">        }</span>
<span class="nc" id="L325">        return sb.toString();</span>
    }
    
    public String mostraInfo(){
<span class="nc" id="L329">        StringBuilder sb = new StringBuilder();</span>
<span class="nc bnc" id="L330" title="All 2 branches missed.">        for(Utilizador u : this.utilizadoresNumPeriodo.values()){</span>
<span class="nc" id="L331">            sb.append(u.toString());</span>
<span class="nc" id="L332">        }</span>
<span class="nc" id="L333">        return sb.toString();</span>
    }

    public double recordMaisPeso(Class&lt;?&gt; tipo){
        double peso;
<span class="nc" id="L338">        peso = recordDouble(tipo, a -&gt; ((AtivRepsPeso)a).getPeso());</span>
<span class="nc" id="L339">        return peso;</span>
    }

    public int recordMaisRepeticoes(Class&lt;?&gt; tipo){
        int reps;
<span class="nc" id="L344">        reps = recordInt(tipo, a -&gt; ((AtivRepeticoes)a).getRepeticoes());</span>
<span class="nc" id="L345">        return reps;</span>
    }

    public double recordMaiorAltimetria(Class&lt;?&gt; tipo){
        double altimetria;
<span class="nc" id="L350">        altimetria = recordDouble(tipo, a -&gt; ((AtivDistAltimetria)a).getAltimetria());</span>
<span class="nc" id="L351">        return altimetria;</span>
    }

    public double recordMaisVelocidade(Class&lt;?&gt; tipo){
        double velocidade;
<span class="nc" id="L356">        velocidade = recordDouble(tipo, a -&gt; ((AtivDistancia)a).getVelocidade());</span>
<span class="nc" id="L357">        return velocidade;</span>
    }

    public int recordMaisTempo(Class&lt;?&gt; tipo){
        int tempo;
<span class="nc" id="L362">        tempo = recordInt(tipo, a -&gt; ((Atividade)a).getTempo().toSecondOfDay());</span>
<span class="nc" id="L363">        return tempo;</span>
    }

    public double recordMaisDistancia(Class&lt;?&gt; tipo){
        double distancia;
<span class="nc" id="L368">        distancia = recordDouble(tipo, a -&gt; ((AtivDistancia)a).getDistancia());</span>
<span class="nc" id="L369">        return distancia;</span>
    }

    public double recordMaisCalorias(Class&lt;?&gt; tipo){
<span class="nc" id="L373">        LocalDate inicio = LocalDate.MIN;</span>
<span class="nc" id="L374">        LocalDate fim = LocalDate.MAX;</span>
<span class="nc" id="L375">        Predicate&lt;Atividade&gt; p = a -&gt; tipo.isInstance(a);</span>
<span class="nc" id="L376">        BiFunction&lt;Atividade,Utilizador,Double&gt; f = (a,u) -&gt; ((Atividade)a).consumoCalorias((Utilizador)u);</span>
<span class="nc" id="L377">        return this.utilizadores.values().stream()</span>
<span class="nc" id="L378">                                .flatMap(u -&gt; u.infoDasAtividadesUtilizadorNumPeriodoQueRespeitamP(inicio, fim, p, f, u).stream())</span>
<span class="nc bnc" id="L379" title="All 2 branches missed.">                                .reduce((n1, n2) -&gt; n1 &gt; n2 ? n1 : n2)</span>
<span class="nc" id="L380">                                .orElse(0.0);</span>
    }

    public double recordDouble(Class&lt;?&gt; tipo, Function&lt;Atividade,Double&gt; f){
<span class="nc" id="L384">        LocalDate inicio = LocalDate.MIN;</span>
<span class="nc" id="L385">        LocalDate fim = LocalDate.MAX;</span>
<span class="nc" id="L386">        Predicate&lt;Atividade&gt; p = a -&gt; tipo.isInstance(a);</span>
<span class="nc" id="L387">        return this.utilizadores.values().stream()</span>
<span class="nc" id="L388">                                .flatMap(u -&gt; u.infoDasAtividadesNumPeriodoQueRespeitamP(inicio, fim, p, f).stream())</span>
<span class="nc bnc" id="L389" title="All 2 branches missed.">                                .reduce((n1, n2) -&gt; n1 &gt; n2 ? n1 : n2)</span>
<span class="nc" id="L390">                                .orElse(0.0);</span>
    }

    public int recordInt(Class&lt;?&gt; tipo, Function&lt;Atividade,Integer&gt; f){
<span class="nc" id="L394">        LocalDate inicio = LocalDate.MIN;</span>
<span class="nc" id="L395">        LocalDate fim = LocalDate.MAX;</span>
<span class="nc" id="L396">        Predicate&lt;Atividade&gt; p = a -&gt; tipo.isInstance(a);</span>
<span class="nc" id="L397">        return this.utilizadores.values().stream()</span>
<span class="nc" id="L398">                                .flatMap(u -&gt; u.infoDasAtividadesNumPeriodoQueRespeitamP(inicio, fim, p, f).stream())</span>
<span class="nc bnc" id="L399" title="All 2 branches missed.">                                .reduce((n1, n2) -&gt; n1 &gt; n2 ? n1 : n2)</span>
<span class="nc" id="L400">                                .orElse(0);</span>
    }

    public List&lt;Atividade&gt; listaAtividades(int[] atividades){
<span class="nc" id="L404">        int size = atividades.length;</span>
<span class="nc" id="L405">        List&lt;Atividade&gt; a = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L406">        int i = 0;</span>
        Atividade at;
<span class="nc bnc" id="L408" title="All 2 branches missed.">        for (i=0; i&lt;size; i++) {</span>
<span class="nc bnc" id="L409" title="All 2 branches missed.">            if (atividades[i] == 1) { //Abdominais</span>
<span class="nc" id="L410">                at = new Abdominais();</span>
            }
<span class="nc bnc" id="L412" title="All 2 branches missed.">            else if (atividades[i] == 2) { //BenchPress</span>
<span class="nc" id="L413">                at = new BenchPress();</span>
            }
<span class="nc bnc" id="L415" title="All 2 branches missed.">            else if (atividades[i] == 3) { //BicepCurls</span>
<span class="nc" id="L416">                at = new BicepCurls();</span>
            }
<span class="nc bnc" id="L418" title="All 2 branches missed.">            else if (atividades[i] == 4) { //Btt</span>
<span class="nc" id="L419">                at = new Btt();</span>
            }
<span class="nc bnc" id="L421" title="All 2 branches missed.">            else if (atividades[i] == 5) { //Ciclismo</span>
<span class="nc" id="L422">                at = new Ciclismo();</span>
            }
<span class="nc bnc" id="L424" title="All 2 branches missed.">            else if (atividades[i] == 6) { //Corrida</span>
<span class="nc" id="L425">                at = new Corrida();</span>
            }
<span class="nc bnc" id="L427" title="All 2 branches missed.">            else if (atividades[i] == 7) { //Flexoes</span>
<span class="nc" id="L428">                at = new Flexoes();</span>
            }
<span class="nc bnc" id="L430" title="All 2 branches missed.">            else if (atividades[i] == 8) { //LegPress</span>
<span class="nc" id="L431">                at = new LegPress();</span>
            }
<span class="nc bnc" id="L433" title="All 2 branches missed.">            else if (atividades[i] == 9) { //Trail</span>
<span class="nc" id="L434">                at = new Trail();</span>
            }
            else
<span class="nc" id="L437">                at = new Corrida();</span>
<span class="nc" id="L438">            a.add(at);</span>
        }
<span class="nc" id="L440">        return a;</span>
    }

    public void geraPlanoTreinoUtilizador(int codUtilizador, int[] atividades, int maxAtivDia, int ativPorSemana, double consumoCaloricoMinimo, LocalDate inicioSemana){
<span class="nc" id="L444">            List&lt;Atividade&gt; a = listaAtividades(atividades);</span>
<span class="nc" id="L445">            List&lt;PlanoTreino&gt; p = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L446">            PlanoTreino plano = new PlanoTreino();</span>
<span class="nc" id="L447">            System.out.println(&quot;Ok\n&quot;);</span>
<span class="nc" id="L448">            p = plano.geraPlanoTreino(this.utilizadores.get(codUtilizador), a, maxAtivDia, ativPorSemana, consumoCaloricoMinimo, inicioSemana);</span>
<span class="nc" id="L449">            int size = p.size();</span>
<span class="nc" id="L450">            int i = 0;</span>
<span class="nc" id="L451">            int res[] = new int[size];</span>
<span class="nc bnc" id="L452" title="All 2 branches missed.">            for (i=0; i&lt;size; i++) {</span>
<span class="nc" id="L453">                this.utilizadores.get(codUtilizador).addPlanoTreino(p.get(i));</span>
<span class="nc" id="L454">                res[i] = p.get(i).getCodPlano();</span>
            }
<span class="nc" id="L456">        }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.13.202504020838</span></div></body></html>