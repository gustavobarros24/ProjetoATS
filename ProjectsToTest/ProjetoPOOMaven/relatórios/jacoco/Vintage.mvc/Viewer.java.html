<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Viewer.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">ProjetoPOO</a> &gt; <a href="index.source.html" class="el_package">Vintage.mvc</a> &gt; <span class="el_source">Viewer.java</span></div><h1>Viewer.java</h1><pre class="source lang-java linenums">package Vintage.mvc;

import java.io.IOException;
import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;
import java.time.format.DateTimeParseException;
import java.util.InputMismatchException;
import java.util.Map;
import java.util.Scanner;
import java.util.regex.Pattern;

public class Viewer {
    private Controller controller;
    private Scanner sc;
    private String currentUser;

<span class="nc" id="L17">    public Viewer(Controller c, Scanner sc) {</span>
<span class="nc" id="L18">        this.controller = c;</span>
<span class="nc" id="L19">        this.sc = sc;</span>
<span class="nc" id="L20">    }</span>

    public void run() {
<span class="nc" id="L23">        int option = showMenu();</span>

<span class="nc" id="L25">        boolean success = this.loadState(option);</span>
<span class="nc bnc" id="L26" title="All 2 branches missed.">        if (!success) return;</span>

<span class="nc" id="L28">        DateTimeFormatter formatter = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH&quot;);</span>

<span class="nc" id="L30">        LocalDateTime initialDate = LocalDateTime.now();</span>

<span class="nc" id="L32">        System.out.println(&quot;\nIndique a data inicial da simulação&quot;);</span>
<span class="nc" id="L33">        System.out.println(&quot;1. Data actual\n2. Data à escolha&quot;);</span>
<span class="nc" id="L34">        System.out.print(&quot;&gt; &quot;);</span>

<span class="nc" id="L36">        option = sc.nextInt();</span>
<span class="nc" id="L37">        sc.nextLine();</span>

<span class="nc bnc" id="L39" title="All 2 branches missed.">        if (option == 2) { </span>
<span class="nc" id="L40">            System.out.println(&quot;Indique a data inicial pretendida (yyyy-MM-dd HH)&quot;);</span>
<span class="nc" id="L41">            System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L42">            String dataInicial = sc.nextLine();</span>

            try {
<span class="nc" id="L45">                initialDate = LocalDateTime.parse(dataInicial, formatter);</span>
<span class="nc" id="L46">                this.controller.changeDate(initialDate);</span>
<span class="nc" id="L47">            } catch (DateTimeParseException e) {</span>
<span class="nc" id="L48">                System.out.println(&quot;Formato inválido!&quot;);</span>
<span class="nc" id="L49">                return;</span>
<span class="nc" id="L50">            }</span>
        }

<span class="nc" id="L53">        this.controller.startSimulation();</span>

<span class="nc" id="L55">        loadState(2);</span>
        //showLoggedInMenu();
<span class="nc" id="L57">    }</span>

    private int showMenu() {
<span class="nc" id="L60">        int option = 0;</span>

<span class="nc" id="L62">        System.out.println(&quot;Como pretende carregar a informação?&quot;);</span>
<span class="nc" id="L63">        System.out.println(&quot;\n1. Carregar de um ficheiro binário\n2. Menu&quot;);</span>
<span class="nc" id="L64">        System.out.print(&quot;&gt; &quot;);</span>

        try {
<span class="nc" id="L67">            option = sc.nextInt();</span>
<span class="nc" id="L68">        } catch (InputMismatchException e) {</span>
<span class="nc" id="L69">            System.out.println(&quot;\nIndique um número inteiro!\n&quot;);</span>
<span class="nc" id="L70">            sc.nextLine(); // Consume the invalid input</span>
<span class="nc" id="L71">            option = showMenu(); // Call the method recursively to get a valid input</span>
<span class="nc" id="L72">        }</span>
    
<span class="nc" id="L74">        return option;</span>
    }

    private boolean loadState(int option) {
        String filename;
<span class="nc bnc" id="L79" title="All 3 branches missed.">        switch (option) {</span>
            case 1:
<span class="nc" id="L81">                System.out.println(&quot;Nome do ficheiro&quot;);</span>
<span class="nc" id="L82">                System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L83">                filename = &quot;./input/&quot; + this.sc.next();</span>
                try {
<span class="nc" id="L85">                    this.controller.setUpReadFromBinaryFile(filename);</span>
<span class="nc" id="L86">                } catch (IOException | ClassNotFoundException e) {</span>
<span class="nc" id="L87">                    System.out.println(e.getMessage());</span>
<span class="nc" id="L88">                    return false;</span>
<span class="nc" id="L89">                }</span>

                break;

            case 2:
                do {
<span class="nc" id="L95">                    System.out.println(&quot;\n0. Terminar\n1. Adicionar utilizador\n2. Entrar com utilizador\n3. Adicionar transportadora\n4. Alterar valor de cálculo de transportadora&quot;);</span>
<span class="nc" id="L96">                    System.out.print(&quot;&gt; &quot;);</span>

                    try {
<span class="nc" id="L99">                        option = sc.nextInt();</span>
<span class="nc" id="L100">                        sc.nextLine();</span>
<span class="nc" id="L101">                    } catch (InputMismatchException e) {</span>
<span class="nc" id="L102">                        System.out.println(&quot;\nIndique um número inteiro!&quot;);</span>
<span class="nc" id="L103">                        sc.nextLine();</span>
<span class="nc" id="L104">                        loadState(option);</span>
<span class="nc" id="L105">                    }</span>

<span class="nc bnc" id="L107" title="All 6 branches missed.">                    switch (option) {</span>
                        case 0:
<span class="nc" id="L109">                            System.out.println(&quot;\nTerminado!&quot;);</span>

<span class="nc" id="L111">                            System.out.println(&quot;Pretende guardar o estado actual em ficheiro? (S/N)&quot;);</span>
<span class="nc" id="L112">                            System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L113">                            String option_g = sc.nextLine();</span>
<span class="nc bnc" id="L114" title="All 4 branches missed.">                            while (!option_g.equals(&quot;S&quot;) &amp;&amp; !option_g.equals(&quot;N&quot;)) {</span>
<span class="nc" id="L115">                                System.out.println(&quot;(S/N)&quot;);</span>
<span class="nc" id="L116">                                System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L117">                                option_g = sc.nextLine();</span>
                            }

<span class="nc bnc" id="L120" title="All 2 branches missed.">                            if (option_g.equals(&quot;S&quot;)) {</span>
                                try {
<span class="nc" id="L122">                                    this.controller.storeState(showStoreStateMenu());</span>
<span class="nc" id="L123">                                } catch (IOException e) {</span>
<span class="nc" id="L124">                                    System.out.println(e.getMessage());</span>
<span class="nc" id="L125">                                }</span>
                            }

                            break;
                        case 1:
<span class="nc" id="L130">                            showUtilizadorMenu();</span>
<span class="nc" id="L131">                            break;</span>
                        case 2:
<span class="nc" id="L133">                            showUtilizador2Menu();</span>
<span class="nc" id="L134">                            break;</span>
                        case 3:
<span class="nc" id="L136">                            showTransportadoraMenu();</span>
<span class="nc" id="L137">                            break;</span>
                        case 4:
<span class="nc" id="L139">                            showAlterarValorTransportadoraMenu();</span>
                            break;
                    }

<span class="nc bnc" id="L143" title="All 2 branches missed.">                } while (option != 0);</span>
                break;
        }

<span class="nc" id="L147">    return true;</span>
    }

    private void showUtilizadorMenu() {
        int optionU;
        do {
<span class="nc" id="L153">            System.out.println(&quot;\nIndique o email pretendido&quot;);</span>
<span class="nc" id="L154">            System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L155">            String email = sc.nextLine();</span>

<span class="nc" id="L157">            System.out.println(&quot;Indique o nome pretendido&quot;);</span>
<span class="nc" id="L158">            System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L159">            String nome = sc.nextLine();</span>

<span class="nc" id="L161">            System.out.println(&quot;Indique a morada pretendida&quot;);</span>
<span class="nc" id="L162">            System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L163">            String morada = sc.nextLine();</span>

<span class="nc" id="L165">            System.out.println(&quot;Indique o nif&quot;);</span>
<span class="nc" id="L166">            System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L167">            String nif = sc.nextLine();</span>

            String em;

            try {
<span class="nc" id="L172">                em = this.controller.addUtilizador(nome, email, morada, nif);</span>
<span class="nc" id="L173">            } catch (IllegalArgumentException e) {</span>
<span class="nc" id="L174">                System.out.println(e.getMessage());</span>
<span class="nc" id="L175">                return;</span>
<span class="nc" id="L176">            }</span>

<span class="nc" id="L178">            System.out.println(&quot;\nO utilizador &quot; + em + &quot; foi adicionado com sucesso.&quot;);</span>
<span class="nc" id="L179">            currentUser = em;</span>
<span class="nc" id="L180">            System.out.println(&quot;\n1. Adicionar mais um utilizador\n2. Entrar&quot;);</span>
<span class="nc" id="L181">            System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L182">            optionU = sc.nextInt();</span>
<span class="nc" id="L183">            sc.nextLine();</span>

<span class="nc bnc" id="L185" title="All 2 branches missed.">        } while (optionU != 2);</span>
<span class="nc" id="L186">        showLoggedInMenu();</span>

            // showVendedorCompradorMenu();
<span class="nc" id="L189">    }</span>

    private void showUtilizador2Menu() {
<span class="nc" id="L192">        System.out.println(&quot;Indique o email do utilizador&quot;);</span>
<span class="nc" id="L193">        System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L194">        String email = sc.nextLine();</span>

<span class="nc bnc" id="L196" title="All 2 branches missed.">        if (this.controller.checkUtilizadorExiste(email)) {</span>
<span class="nc" id="L197">            currentUser = email;</span>
<span class="nc" id="L198">            System.out.println(&quot;Sessão iniciada com utilizador &quot; + email);</span>
<span class="nc" id="L199">            showLoggedInMenu();</span>
        }

        else {
<span class="nc" id="L203">            System.out.println(&quot;\nUtilizador não existe!&quot;);</span>
        }
<span class="nc" id="L205">    }</span>

    private void showTransportadoraMenu() {
<span class="nc" id="L208">        System.out.println(&quot;\nIndique o nome pretendido&quot;);</span>
<span class="nc" id="L209">        System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L210">        String nome = sc.nextLine();</span>

<span class="nc" id="L212">        float imposto = 0.0f;</span>
<span class="nc" id="L213">        boolean validInput = false;</span>
<span class="nc bnc" id="L214" title="All 2 branches missed.">        while (!validInput) {</span>
<span class="nc" id="L215">            System.out.println(&quot;Indique o imposto pretendido&quot;);</span>
<span class="nc" id="L216">            System.out.print(&quot;&gt; &quot;);</span>
            
            try {
<span class="nc" id="L219">                imposto = sc.nextFloat();</span>
<span class="nc" id="L220">                validInput = true;</span>
<span class="nc" id="L221">            } catch (InputMismatchException e) {</span>
<span class="nc" id="L222">                System.out.println(&quot;Indique um valor numérico!\n&quot;);</span>
<span class="nc" id="L223">                sc.nextLine(); </span>
<span class="nc" id="L224">            }</span>
        }
<span class="nc" id="L226">        sc.nextLine(); </span>

<span class="nc" id="L228">        float valorPeq = 0.0f;</span>
<span class="nc" id="L229">        validInput = false;</span>
<span class="nc bnc" id="L230" title="All 2 branches missed.">        while (!validInput) {</span>
<span class="nc" id="L231">            System.out.println(&quot;Indique o valor de expedição de uma encomenda pequena pretendido&quot;);</span>
<span class="nc" id="L232">            System.out.print(&quot;&gt; &quot;);</span>
           
            try {
<span class="nc" id="L235">                valorPeq = sc.nextFloat();</span>
<span class="nc" id="L236">                validInput = true;</span>
<span class="nc" id="L237">            } catch (InputMismatchException e) {</span>
<span class="nc" id="L238">                System.out.println(&quot;Indique um valor numérico!\n&quot;);</span>
<span class="nc" id="L239">                sc.nextLine(); </span>
<span class="nc" id="L240">            }</span>
        }
<span class="nc" id="L242">        sc.nextLine(); </span>

<span class="nc" id="L244">        float valorMed = 0.0f;</span>
<span class="nc" id="L245">        validInput = false;</span>
<span class="nc bnc" id="L246" title="All 2 branches missed.">        while (!validInput) {</span>
<span class="nc" id="L247">            System.out.println(&quot;Indique o valor de expedição de uma encomenda média pretendido&quot;);</span>
<span class="nc" id="L248">            System.out.print(&quot;&gt; &quot;);</span>
            
            try {
<span class="nc" id="L251">                valorMed = sc.nextFloat();</span>
<span class="nc" id="L252">                validInput = true;</span>
<span class="nc" id="L253">            } catch (InputMismatchException e) {</span>
<span class="nc" id="L254">                System.out.println(&quot;Indique um valor numérico!\n&quot;);</span>
<span class="nc" id="L255">                sc.nextLine(); </span>
<span class="nc" id="L256">            }</span>
        }
<span class="nc" id="L258">        sc.nextLine(); </span>

<span class="nc" id="L260">        float valorGra = 0.0f;</span>
<span class="nc" id="L261">        validInput = false;</span>
<span class="nc bnc" id="L262" title="All 2 branches missed.">        while (!validInput) {</span>
<span class="nc" id="L263">            System.out.println(&quot;Indique o valor de expedição de uma encomenda grande pretendido&quot;);</span>
<span class="nc" id="L264">            System.out.print(&quot;&gt; &quot;);</span>
            try {
<span class="nc" id="L266">                valorGra = sc.nextFloat();</span>
<span class="nc" id="L267">                validInput = true;</span>
<span class="nc" id="L268">            } catch (InputMismatchException e) {</span>
<span class="nc" id="L269">                System.out.println(&quot;Indique um valor numérico!\n&quot;);</span>
<span class="nc" id="L270">                sc.nextLine(); </span>
<span class="nc" id="L271">            }</span>
        }
<span class="nc" id="L273">        sc.nextLine(); </span>

<span class="nc" id="L275">        float margemLucro = 0.0f;</span>
<span class="nc" id="L276">        validInput = false;</span>
<span class="nc bnc" id="L277" title="All 2 branches missed.">        while (!validInput) {</span>
<span class="nc" id="L278">            System.out.println(&quot;Indique a margem de lucro pretendida&quot;);</span>
<span class="nc" id="L279">            System.out.print(&quot;&gt; &quot;);</span>
            
            try {
<span class="nc" id="L282">                margemLucro = sc.nextFloat();</span>
<span class="nc" id="L283">                validInput = true;</span>
<span class="nc" id="L284">            } catch (InputMismatchException e) {</span>
<span class="nc" id="L285">                System.out.println(&quot;Indique um valor numérico!\n&quot;);</span>
<span class="nc" id="L286">                sc.nextLine(); </span>
<span class="nc" id="L287">            }</span>
        }
<span class="nc" id="L289">        sc.nextLine();</span>

        String n;

        try {
<span class="nc" id="L294">            n = this.controller.addTransportadora(nome, imposto, valorPeq, valorMed, valorGra, margemLucro);</span>
<span class="nc" id="L295">        } catch (IllegalArgumentException e) {</span>
<span class="nc" id="L296">            System.out.println(e.getMessage());</span>
<span class="nc" id="L297">            return;</span>
<span class="nc" id="L298">        }</span>

<span class="nc" id="L300">        System.out.println(&quot;\nA transportadora &quot; + n + &quot; foi adicionada com sucesso.&quot;);</span>

<span class="nc" id="L302">    }</span>

    private void showAlterarValorTransportadoraMenu() {
<span class="nc bnc" id="L305" title="All 2 branches missed.">        if (this.controller.getNumTransportadoras() &gt; 0) {</span>
<span class="nc" id="L306">            System.out.println(&quot;Indique a transportadora que pretende alterar&quot;);</span>

<span class="nc" id="L308">            this.controller.showTransportadoras();</span>
<span class="nc" id="L309">            System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L310">            String transportadora = sc.nextLine();</span>
<span class="nc bnc" id="L311" title="All 2 branches missed.">            while (!this.controller.checkTransportadoraExiste(transportadora)) {</span>
<span class="nc" id="L312">                System.out.println(&quot;selecione uma das apresentadas!&quot;);</span>
<span class="nc" id="L313">                this.controller.showTransportadoras();</span>
<span class="nc" id="L314">                System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L315">                transportadora = sc.nextLine();</span>
            }

<span class="nc" id="L318">            System.out.println(&quot;0. Voltar\n1. Alterar valor base encomendas pequenas\n2. Alterar valor base encomendas médias\n3. Alterar valor base encomendas grandes\n4. Alterar margem de lucro\n5. Alterar imposto\n6. Alterar fórmula&quot;);</span>
            
<span class="nc" id="L320">            System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L321">            int option = sc.nextInt();</span>
<span class="nc" id="L322">            sc.nextLine();</span>
<span class="nc" id="L323">            float valor = 0.0f;</span>

<span class="nc bnc" id="L325" title="All 8 branches missed.">            switch (option) {</span>
                case 0: 
<span class="nc" id="L327">                    break;</span>
                case 1:
<span class="nc" id="L329">                    System.out.println(&quot;Indique o novo valor base para encomendas pequenas pretendido. Atual: &quot; + this.controller.showValorTransportadora(transportadora, option));</span>
<span class="nc" id="L330">                    System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L331">                    valor = sc.nextFloat();</span>
<span class="nc" id="L332">                    this.controller.alterarValorTransportadora(transportadora, option, valor);</span>
<span class="nc" id="L333">                    System.out.println(&quot;\nValor atualizado com sucesso!&quot;);</span>
<span class="nc" id="L334">                    break;</span>
                case 2:
<span class="nc" id="L336">                    System.out.println(&quot;Indique o novo valor base para encomendas médias pretendido. Atual: &quot; + this.controller.showValorTransportadora(transportadora, option));</span>
<span class="nc" id="L337">                    System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L338">                    valor = sc.nextFloat();</span>
<span class="nc" id="L339">                    this.controller.alterarValorTransportadora(transportadora, option, valor);</span>
<span class="nc" id="L340">                    System.out.println(&quot;\nValor atualizado com sucesso!&quot;);</span>
<span class="nc" id="L341">                    break;</span>
                case 3:
<span class="nc" id="L343">                    System.out.println(&quot;Indique o novo valor base para encomendas grandes pretendido. Atual: &quot; + this.controller.showValorTransportadora(transportadora, option));</span>
<span class="nc" id="L344">                    System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L345">                    valor = sc.nextFloat();</span>
<span class="nc" id="L346">                    this.controller.alterarValorTransportadora(transportadora, option, valor);</span>
<span class="nc" id="L347">                    System.out.println(&quot;\nValor atualizado com sucesso!&quot;);</span>
<span class="nc" id="L348">                    break;</span>
                case 4:
<span class="nc" id="L350">                    System.out.println(&quot;Indique a nova margem de lucro pretendida. Atual: &quot; + this.controller.showValorTransportadora(transportadora, option));</span>
<span class="nc" id="L351">                    System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L352">                    valor = sc.nextFloat();</span>
<span class="nc" id="L353">                    this.controller.alterarValorTransportadora(transportadora, option, valor);</span>
<span class="nc" id="L354">                    System.out.println(&quot;\nValor atualizado com sucesso!&quot;);</span>
<span class="nc" id="L355">                    break;</span>
                case 5:
<span class="nc" id="L357">                    System.out.println(&quot;Indique o novo imposto pretendido. Atual: &quot; + this.controller.showValorTransportadora(transportadora, option));</span>
<span class="nc" id="L358">                    System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L359">                    valor = sc.nextFloat();</span>
<span class="nc" id="L360">                    this.controller.alterarValorTransportadora(transportadora, option, valor);</span>
<span class="nc" id="L361">                    System.out.println(&quot;\nValor atualizado com sucesso!&quot;);</span>
<span class="nc" id="L362">                    break;</span>
                case 6:
<span class="nc" id="L364">                    System.out.println(&quot;Indique a nova fórmula pretendida. Atual: &quot; + this.controller.showFormulaTransportadora(transportadora));</span>
<span class="nc" id="L365">                    System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L366">                    String formula = sc.nextLine();</span>

<span class="nc" id="L368">                    String pattern = &quot;^[0-9+\\-*/().\\sVBMLTI]*$&quot;;</span>
<span class="nc bnc" id="L369" title="All 2 branches missed.">                    while (!Pattern.matches(pattern, formula)) {</span>
<span class="nc" id="L370">                        System.out.println(&quot;Siga as regras das fórmulas!&quot;);</span>
<span class="nc" id="L371">                        System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L372">                        formula = sc.nextLine();</span>
                    }

<span class="nc" id="L375">                    this.controller.alterarFormulaTransportadora(transportadora, formula);</span>

<span class="nc" id="L377">                    System.out.println(&quot;\nFórmula alterada com sucesso!&quot;);</span>
            }

<span class="nc" id="L380">        }</span>

        else {
<span class="nc" id="L383">            System.out.println(&quot;\nDado não existirem transportadoras no sistema, não é possível alterar valores de cálculo! Tente mais tarde.&quot;);</span>
        }
<span class="nc" id="L385">    }</span>

    private void showLoggedInMenu() {
        int optionL;
        do {
<span class="nc" id="L390">            System.out.println(&quot;\n0. Voltar\n1. Ver e/ou comprar artigos\n2. Colocar artigo à venda\n3. Consultar e/ou finalizar encomenda\n4. Devolver encomenda\n5. Estatísticas\n6. Ver faturas\n7. Avançar no tempo&quot;);</span>
<span class="nc" id="L391">            System.out.print(&quot;&gt; &quot;);</span>

<span class="nc" id="L393">            optionL = sc.nextInt();</span>
<span class="nc" id="L394">            sc.nextLine();</span>

<span class="nc bnc" id="L396" title="All 9 branches missed.">            switch (optionL) {</span>
                case 0:
<span class="nc" id="L398">                    break;</span>
                case 1:
<span class="nc" id="L400">                    showArtigosMenu();</span>
<span class="nc" id="L401">                    break;</span>
                case 2:
<span class="nc" id="L403">                    showVenderArtigoMenu();</span>
<span class="nc" id="L404">                    break;</span>
                case 3:
<span class="nc" id="L406">                    showEncomenda();</span>
<span class="nc" id="L407">                    break;</span>
                case 4:
<span class="nc" id="L409">                    showDevolverEncomenda();</span>
<span class="nc" id="L410">                    break;</span>
                case 5:
<span class="nc" id="L412">                    showEstatisticasMenu();</span>
<span class="nc" id="L413">                    break;</span>
                case 6:
<span class="nc" id="L415">                    showFaturasMenu();</span>
<span class="nc" id="L416">                    break;</span>
                case 7:
<span class="nc" id="L418">                    showAvancarMenu();</span>
                    break;
            }
<span class="nc bnc" id="L421" title="All 2 branches missed.">        } while (optionL != 0);</span>
<span class="nc" id="L422">    }</span>

    private void showFaturasMenu() {
<span class="nc" id="L425">        boolean hasFaturas = this.controller.checkUtilizadorTemFaturas(currentUser);</span>

<span class="nc bnc" id="L427" title="All 2 branches missed.">        if (!hasFaturas) {</span>
<span class="nc" id="L428">            System.out.println(&quot;\nDe momento, o utilizador não tem faturas!&quot;);</span>
        }

        else {
<span class="nc" id="L432">            String answer = this.controller.showFaturas(currentUser);</span>
<span class="nc" id="L433">            System.out.println(answer);</span>
        }
<span class="nc" id="L435">    }</span>

    private void showAvancarMenu() {
<span class="nc" id="L438">        System.out.println(&quot;Quantas horas pretende avançar?&quot;);</span>
<span class="nc" id="L439">        System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L440">        int hours = sc.nextInt();</span>

<span class="nc" id="L442">        this.controller.avancar(hours);</span>
<span class="nc" id="L443">        this.controller.startSimulation();</span>
    
<span class="nc" id="L445">        System.out.println(&quot;\nO tempo foi adiantado em &quot; + hours + &quot; horas!&quot;);</span>
<span class="nc" id="L446">    }</span>

    private void showVenderArtigoMenu() {
<span class="nc bnc" id="L449" title="All 2 branches missed.">        if (this.controller.getNumTransportadoras() &gt; 0) {</span>
<span class="nc" id="L450">            System.out.println(&quot;\nIndique o nome do artigo&quot;);</span>
<span class="nc" id="L451">            System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L452">            String nome = sc.nextLine();</span>

<span class="nc" id="L454">            System.out.println(&quot;Indique a descrição do artigo&quot;);</span>
<span class="nc" id="L455">            System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L456">            String descricao = sc.nextLine();</span>

<span class="nc" id="L458">            System.out.println(&quot;Indique a marca do artigo&quot;);</span>
<span class="nc" id="L459">            System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L460">            String marca = sc.nextLine();</span>

<span class="nc" id="L462">            System.out.println(&quot;Indique o código do artigo&quot;);</span>
<span class="nc" id="L463">            System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L464">            Integer codigo = sc.nextInt();</span>
        
<span class="nc" id="L466">            System.out.println(&quot;Indique o preço base do artigo&quot;);</span>
<span class="nc" id="L467">            System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L468">            float precoBase = sc.nextFloat();</span>

<span class="nc" id="L470">            System.out.println(&quot;Indique a correção de preço do artigo&quot;);</span>
<span class="nc" id="L471">            System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L472">            float correcaoPreco = sc.nextFloat();</span>
     
<span class="nc" id="L474">            System.out.println(&quot;O artigo é novo ou usado? (N/U)&quot;);</span>
<span class="nc" id="L475">            System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L476">            String novo_tmp = sc.nextLine();</span>
<span class="nc" id="L477">            System.out.print(novo_tmp);</span>
            boolean novo;
            int numDonos;
<span class="nc bnc" id="L480" title="All 4 branches missed.">            while (!novo_tmp.equals(&quot;U&quot;) &amp;&amp; !novo_tmp.equals(&quot;N&quot;)) {</span>
<span class="nc" id="L481">                System.out.println(&quot;(N/U)&quot;);</span>
<span class="nc" id="L482">                System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L483">                novo_tmp = sc.nextLine();</span>
            }
<span class="nc bnc" id="L485" title="All 2 branches missed.">            if (novo_tmp.equals(&quot;U&quot;)) {</span>
<span class="nc" id="L486">                System.out.println(&quot;Indique o número de donos prévios&quot;);</span>
<span class="nc" id="L487">                System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L488">                numDonos = sc.nextInt();</span>
<span class="nc" id="L489">                sc.nextLine();</span>
<span class="nc" id="L490">                novo = false;</span>
            }
            else {
<span class="nc" id="L493">                numDonos = 0;</span>
<span class="nc" id="L494">                novo = true;</span>
            }

<span class="nc" id="L497">            System.out.println(&quot;Indique a condição do artigo&quot;);</span>
<span class="nc" id="L498">            System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L499">            String condicao = sc.nextLine();</span>

<span class="nc" id="L501">            System.out.println(&quot;Indique a transportadora que pretende utilizar (selecionar uma das apresentadas)&quot;);</span>
<span class="nc" id="L502">            this.controller.showTransportadoras();</span>
<span class="nc" id="L503">            System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L504">            String transportadora = sc.nextLine();</span>
<span class="nc bnc" id="L505" title="All 2 branches missed.">            while (!this.controller.checkTransportadoraExiste(transportadora)) {</span>
<span class="nc" id="L506">                System.out.println(&quot;selecione uma das apresentadas!&quot;);</span>
<span class="nc" id="L507">                this.controller.showTransportadoras();</span>
<span class="nc" id="L508">                System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L509">                transportadora = sc.nextLine();</span>
            }

<span class="nc" id="L512">            System.out.println(&quot;Indique o stock do artigo&quot;);</span>
<span class="nc" id="L513">            System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L514">            int stock = sc.nextInt();</span>
<span class="nc" id="L515">            sc.nextLine();</span>
<span class="nc bnc" id="L516" title="All 2 branches missed.">            while (stock &lt;= 0) {</span>
<span class="nc" id="L517">                System.out.println(&quot;Indique um valor superior a 0!&quot;);</span>
<span class="nc" id="L518">                System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L519">                stock = sc.nextInt();</span>
<span class="nc" id="L520">                sc.nextLine();</span>
            }

            int optionA;
            do {
<span class="nc" id="L525">                System.out.println(&quot;Qual é o tipo do artigo?&quot;);</span>
<span class="nc" id="L526">                System.out.println(&quot;\n1. Mala\n2. Sapatilha\n3. T-Shirt\n&quot;);</span>
<span class="nc" id="L527">                System.out.print(&quot;&gt; &quot;);</span>

<span class="nc" id="L529">                optionA = sc.nextInt();</span>
<span class="nc" id="L530">                sc.nextLine();</span>

<span class="nc bnc" id="L532" title="All 4 branches missed.">                switch (optionA) {</span>
                    case 1:
<span class="nc" id="L534">                        showAddMalaMenu(nome, descricao, marca, codigo, precoBase, correcaoPreco, novo, numDonos, condicao, transportadora, stock);</span>
<span class="nc" id="L535">                        break;</span>
                    case 2:
<span class="nc" id="L537">                        showAddSapatilhaMenu(nome, descricao, marca, codigo, precoBase, correcaoPreco, novo, numDonos, condicao, transportadora, stock);</span>
<span class="nc" id="L538">                        break;</span>
                    case 3:
<span class="nc" id="L540">                        showAddTShirtMenu(nome, descricao, marca, codigo, precoBase, correcaoPreco, novo, numDonos, condicao, transportadora, stock);</span>
                        break;
                }
<span class="nc bnc" id="L543" title="All 6 branches missed.">            } while (optionA != 1 &amp;&amp; optionA != 2 &amp;&amp; optionA != 3);</span>
<span class="nc" id="L544">        }</span>
        else {
<span class="nc" id="L546">            System.out.println(&quot;\nDado não existirem transportadoras no sistema, não é possível adicionar artigos! Tente mais tarde.&quot;);</span>
        }
<span class="nc" id="L548">    }</span>

    private void showAddMalaMenu(String nome, String descricao, String marca, Integer codigo, float precoBase, float correcaoPreco, boolean novo, int numDonos, String condicao, String transportadora, int stock) {
<span class="nc" id="L551">        System.out.println(&quot;Indique a dimensão da mala&quot;);</span>
<span class="nc" id="L552">        System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L553">        float dimensao = sc.nextFloat();</span>
<span class="nc" id="L554">        sc.nextLine(); </span>
        
<span class="nc" id="L556">        System.out.println(&quot;Indique o material da mala&quot;);</span>
<span class="nc" id="L557">        System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L558">        String material = sc.nextLine();</span>

<span class="nc" id="L560">        System.out.println(&quot;Indique o ano de colecção da mala&quot;);</span>
<span class="nc" id="L561">        System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L562">        int anoColecao = sc.nextInt();</span>

<span class="nc" id="L564">        System.out.println(&quot;A mala é premium? (S/N)&quot;);</span>
<span class="nc" id="L565">        System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L566">        String option_c = sc.nextLine();</span>
<span class="nc bnc" id="L567" title="All 4 branches missed.">        while (!option_c.equals(&quot;S&quot;) &amp;&amp; !option_c.equals(&quot;N&quot;)) {</span>
<span class="nc" id="L568">            System.out.println(&quot;(S/N)&quot;);</span>
<span class="nc" id="L569">            System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L570">            option_c = sc.nextLine();</span>
        }
        boolean premium;
<span class="nc bnc" id="L573" title="All 2 branches missed.">        if (option_c.equals(&quot;S&quot;)) {</span>
<span class="nc" id="L574">            premium = true;</span>
        }
        else {
<span class="nc" id="L577">            premium = false;</span>
        }

<span class="nc" id="L580">        System.out.println(&quot;Indique a valorização da mala&quot;);</span>
<span class="nc" id="L581">        System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L582">        float valorizacao = sc.nextFloat();</span>

        String n;

        try {
<span class="nc" id="L587">            n = this.controller.addMala(nome, descricao, marca, codigo, precoBase, correcaoPreco, novo, numDonos, condicao, transportadora, stock, dimensao, material, anoColecao, premium, valorizacao, currentUser);</span>
<span class="nc bnc" id="L588" title="All 2 branches missed.">            if (n.equals(&quot;null&quot;)) {</span>
<span class="nc" id="L589">                System.out.println(&quot;Já existe um artigo com o código &quot; + codigo + &quot;!\n&quot;);</span>
            }
            else {
<span class="nc" id="L592">                System.out.println(&quot;\nA mala &quot; + n + &quot; foi adicionada com sucesso.\n&quot;);</span>
            }
<span class="nc" id="L594">        } catch (IllegalArgumentException e) {</span>
<span class="nc" id="L595">            System.out.println(e.getMessage());</span>
<span class="nc" id="L596">            return;</span>
<span class="nc" id="L597">        }</span>

<span class="nc" id="L599">    }</span>

    private void showAddSapatilhaMenu(String nome, String descricao, String marca, Integer codigo, float precoBase, float correcaoPreco, boolean novo, int numDonos, String condicao, String transportadora, int stock) {
<span class="nc" id="L602">        System.out.println(&quot;Indique o tamanho das sapatilhas&quot;);</span>
<span class="nc" id="L603">        System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L604">        int tamanho = sc.nextInt();</span>
<span class="nc" id="L605">        sc.nextLine(); </span>
        
<span class="nc" id="L607">        System.out.println(&quot;As sapatilhas possuem atacadores? (S/N)&quot;);</span>
<span class="nc" id="L608">        System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L609">        String option_c = sc.nextLine();</span>
<span class="nc bnc" id="L610" title="All 4 branches missed.">        while (!option_c.equals(&quot;S&quot;) &amp;&amp; !option_c.equals(&quot;N&quot;)) {</span>
<span class="nc" id="L611">            System.out.println(&quot;(S/N)&quot;);</span>
<span class="nc" id="L612">            System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L613">            option_c = sc.nextLine();</span>
        }
        boolean atacadores;
<span class="nc bnc" id="L616" title="All 2 branches missed.">        if (option_c.equals(&quot;S&quot;)) {</span>
<span class="nc" id="L617">            atacadores = true;</span>
        }
        else {
<span class="nc" id="L620">            atacadores = false;</span>
        }

<span class="nc" id="L623">        System.out.println(&quot;Indique a cor das sapatilhas&quot;);</span>
<span class="nc" id="L624">        System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L625">        String cor = sc.nextLine();</span>

<span class="nc" id="L627">        System.out.println(&quot;Indique o ano de lançamento das sapatilhas&quot;);</span>
<span class="nc" id="L628">        System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L629">        int anoLancamento = sc.nextInt();</span>
<span class="nc" id="L630">        sc.nextLine(); </span>
        
<span class="nc" id="L632">        System.out.println(&quot;As sapatilhas são premium? (S/N)&quot;);</span>
<span class="nc" id="L633">        System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L634">        String option_c2 = sc.nextLine();</span>
<span class="nc bnc" id="L635" title="All 4 branches missed.">        while (!option_c2.equals(&quot;S&quot;) &amp;&amp; !option_c2.equals(&quot;N&quot;)) {</span>
<span class="nc" id="L636">            System.out.println(&quot;(S/N)&quot;);</span>
<span class="nc" id="L637">            System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L638">            option_c2 = sc.nextLine();</span>
        }
        boolean premium;
<span class="nc bnc" id="L641" title="All 2 branches missed.">        if (option_c2.equals(&quot;S&quot;)) {</span>
<span class="nc" id="L642">            premium = true;</span>
        }
        else {
<span class="nc" id="L645">            premium = false;</span>
        }

        String n;

        try {
<span class="nc" id="L651">            n = this.controller.addSapatilha(nome, descricao, marca, codigo, precoBase, correcaoPreco, novo, numDonos, condicao, transportadora, stock, tamanho, atacadores, cor, anoLancamento, premium, currentUser);</span>
<span class="nc bnc" id="L652" title="All 2 branches missed.">            if (n.equals(&quot;null&quot;)) {</span>
<span class="nc" id="L653">                System.out.println(&quot;Já existe um artigo com o código &quot; + codigo + &quot;!\n&quot;);</span>
            }
            else {
<span class="nc" id="L656">                System.out.println(&quot;\nAs sapatilhas &quot; + n + &quot; foram adicionadas com sucesso.\n&quot;);</span>
            }
<span class="nc" id="L658">        } catch (IllegalArgumentException e) {</span>
<span class="nc" id="L659">            System.out.println(e.getMessage());</span>
<span class="nc" id="L660">            return;</span>
<span class="nc" id="L661">        }</span>
<span class="nc" id="L662">    }</span>

    private void showAddTShirtMenu(String nome, String descricao, String marca, Integer codigo, float precoBase, float correcaoPreco, boolean novo, int numDonos, String condicao, String transportadora, int stock) {
<span class="nc" id="L665">        System.out.println(&quot;Indique o tamanho da t-shirt (S/M/L/XL)&quot;);</span>
<span class="nc" id="L666">        System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L667">        String tamanho = sc.nextLine();</span>
<span class="nc bnc" id="L668" title="All 8 branches missed.">        while (!tamanho.equals(&quot;S&quot;) &amp;&amp; !tamanho.equals(&quot;M&quot;) &amp;&amp; !tamanho.equals(&quot;L&quot;) &amp;&amp; !tamanho.equals(&quot;XL&quot;)) {</span>
<span class="nc" id="L669">            System.out.println(&quot;(S/M/L/XL)&quot;);</span>
<span class="nc" id="L670">            System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L671">            tamanho = sc.nextLine();</span>
        }


<span class="nc" id="L675">        System.out.println(&quot;Indique o padrão da t-shirt (LISO/RISCAS/PALMEIRAS)&quot;);</span>
<span class="nc" id="L676">        System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L677">        String padrao = sc.nextLine();</span>
<span class="nc bnc" id="L678" title="All 6 branches missed.">        while (!padrao.equals(&quot;LISO&quot;) &amp;&amp; !padrao.equals(&quot;RISCAS&quot;) &amp;&amp; !padrao.equals(&quot;PALMEIRAS&quot;)) {</span>
<span class="nc" id="L679">            System.out.println(&quot;(LISO/RISCAS/PALMEIRAS))&quot;);</span>
<span class="nc" id="L680">            System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L681">            padrao = sc.nextLine();</span>
        }

<span class="nc" id="L684">        System.out.println(&quot;Indique o desconto da t-shirt&quot;);</span>
<span class="nc" id="L685">        System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L686">        int desconto = sc.nextInt();</span>
<span class="nc" id="L687">        sc.nextLine();</span>


        String n;

        try {
<span class="nc" id="L693">            n = this.controller.addTShirt(nome, descricao, marca, codigo, precoBase, correcaoPreco, novo, numDonos, condicao, transportadora, stock, tamanho, padrao, desconto, currentUser);</span>
<span class="nc bnc" id="L694" title="All 2 branches missed.">            if (n.equals(&quot;null&quot;)) {</span>
<span class="nc" id="L695">                System.out.println(&quot;Já existe um artigo com o código &quot; + codigo + &quot;!\n&quot;);</span>
            }
            else {
<span class="nc" id="L698">                System.out.println(&quot;\nA T-Shirt &quot; + n + &quot; foi adicionada com sucesso.\n&quot;);</span>
            }
<span class="nc" id="L700">        } catch (IllegalArgumentException e) {</span>
<span class="nc" id="L701">            System.out.println(e.getMessage());</span>
<span class="nc" id="L702">            return;</span>
<span class="nc" id="L703">        }</span>
<span class="nc" id="L704">    }</span>

    private void showArtigosMenu() {
<span class="nc bnc" id="L707" title="All 2 branches missed.">        if (this.controller.getNumArtigos() &gt; 0) {</span>
<span class="nc" id="L708">            System.out.print(this.controller.showArtigos());</span>

<span class="nc" id="L710">            System.out.println(&quot;\nDeseja comprar algum dos artigos? (S/N)&quot;);</span>
<span class="nc" id="L711">            System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L712">            String option_c = sc.nextLine();</span>
<span class="nc bnc" id="L713" title="All 4 branches missed.">            while (!option_c.equals(&quot;S&quot;) &amp;&amp; !option_c.equals(&quot;N&quot;)) {</span>
<span class="nc" id="L714">                System.out.println(&quot;(S/N)&quot;);</span>
<span class="nc" id="L715">                System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L716">                option_c = sc.nextLine();</span>
            }

<span class="nc bnc" id="L719" title="All 2 branches missed.">            if (option_c.equals(&quot;S&quot;)) {</span>
<span class="nc" id="L720">                System.out.println(&quot;Qual o código do artigo desejado?&quot;);</span>
<span class="nc" id="L721">                System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L722">                Integer option_codigo = sc.nextInt();</span>

<span class="nc" id="L724">                System.out.println(&quot;Qual o número de stock pretendido?&quot;);</span>
<span class="nc" id="L725">                System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L726">                Integer option_stock = sc.nextInt();</span>

<span class="nc bnc" id="L728" title="All 2 branches missed.">                if (this.controller.checkEncomendaVazia(currentUser)) {</span>
<span class="nc" id="L729">                    this.controller.initEncomendaUser(currentUser);</span>
                }

<span class="nc" id="L732">                Integer r = this.controller.addArtigoEncomenda(option_codigo, option_stock, currentUser);</span>
<span class="nc bnc" id="L733" title="All 2 branches missed.">                if (r == 0) {</span>
<span class="nc" id="L734">                    System.out.println(&quot;\nArtigo não existe!&quot;);</span>
                }

<span class="nc bnc" id="L737" title="All 2 branches missed.">                else if (r == -1) {</span>
<span class="nc" id="L738">                    System.out.println(&quot;\nStock insuficiente!&quot;);</span>
                }

                else {
<span class="nc" id="L742">                    System.out.println(&quot;\nArtigo com o código &quot; + option_codigo  + &quot; adicionado com sucesso!&quot;);</span>
                }
            }
<span class="nc" id="L745">        }</span>

        else {
<span class="nc" id="L748">            System.out.println(&quot;\nNenhum artigo disponível de momento!&quot;);</span>
        }
<span class="nc" id="L750">    }</span>

    private void showDevolverEncomenda() {
<span class="nc" id="L753">        boolean hasEncomendas = this.controller.checkUtilizadorEncADevolver(currentUser);</span>
        
<span class="nc bnc" id="L755" title="All 2 branches missed.">        if (!hasEncomendas) {</span>
<span class="nc" id="L756">            System.out.println(&quot;\nDe momento, não há encomendas disponíveis para serem devolvidas!&quot;);</span>
        }
        else {
<span class="nc" id="L759">            String answer = this.controller.showEncomendasFeitas(currentUser);</span>
<span class="nc" id="L760">            System.out.println(answer);</span>

<span class="nc" id="L762">            System.out.println(&quot;\nDeseja devolver alguma das encomendas? (S/N)&quot;);</span>
<span class="nc" id="L763">            System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L764">            String option_d = sc.nextLine();</span>
<span class="nc bnc" id="L765" title="All 4 branches missed.">            while (!option_d.equals(&quot;S&quot;) &amp;&amp; !option_d.equals(&quot;N&quot;)) {</span>
<span class="nc" id="L766">                System.out.println(&quot;(S/N)&quot;);</span>
<span class="nc" id="L767">                System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L768">                option_d = sc.nextLine();</span>
            }

<span class="nc bnc" id="L771" title="All 2 branches missed.">            if (option_d.equals(&quot;S&quot;)) {</span>
<span class="nc" id="L772">                System.out.println(&quot;Qual o código da encomenda que deseja devolver?&quot;);</span>
<span class="nc" id="L773">                System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L774">                Integer option_codigo = sc.nextInt();</span>

<span class="nc bnc" id="L776" title="All 2 branches missed.">                if (!this.controller.checkUtilizadorTemEncADevolver(option_codigo, currentUser)) {</span>
<span class="nc" id="L777">                    System.out.println(&quot;\nNenhuma encomenda com esse código!&quot;);</span>
                }

                else {
<span class="nc" id="L781">                    this.controller.devolverEncomenda(currentUser, option_codigo);</span>
<span class="nc" id="L782">                    System.out.println(&quot;A encomenda foi devolvida com sucesso!&quot;) ;                  </span>
                }
            }
        }
<span class="nc" id="L786">    }</span>

    private void showEncomenda() {
<span class="nc" id="L789">        String answer = this.controller.showEncomenda(currentUser);</span>
<span class="nc" id="L790">        System.out.println(answer);</span>

<span class="nc bnc" id="L792" title="All 2 branches missed.">        if (!answer.equals(&quot;\nSem artigos na encomenda!&quot;)) {</span>
<span class="nc" id="L793">            System.out.println(&quot;0. Voltar\n1. Finalizar encomenda\n2. Remover artigo da encomenda&quot;);</span>
<span class="nc" id="L794">            System.out.print(&quot;&gt; &quot;);</span>

<span class="nc" id="L796">            int option_e = sc.nextInt();</span>
<span class="nc" id="L797">            sc.nextLine();</span>

<span class="nc bnc" id="L799" title="All 4 branches missed.">            switch (option_e) {</span>
                case 0:
<span class="nc" id="L801">                    showLoggedInMenu();</span>
<span class="nc" id="L802">                    break;</span>
                case 1:
<span class="nc" id="L804">                    float preco = this.controller.calcularPrecoFinalEncomenda(currentUser);</span>
<span class="nc" id="L805">                    System.out.println(&quot;O preço final é &quot; + preco);</span>
<span class="nc" id="L806">                    System.out.println(&quot;Deseja prosseguir com a compra? (S/N)&quot;);</span>
<span class="nc" id="L807">                    System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L808">                    String option_cc = sc.nextLine();</span>
<span class="nc bnc" id="L809" title="All 4 branches missed.">                    while (!option_cc.equals(&quot;S&quot;) &amp;&amp; !option_cc.equals(&quot;N&quot;)) {</span>
<span class="nc" id="L810">                        System.out.println(&quot;(S/N)&quot;);</span>
<span class="nc" id="L811">                        System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L812">                        option_cc = sc.nextLine();</span>
                    }

<span class="nc bnc" id="L815" title="All 2 branches missed.">                    if (option_cc.equals(&quot;S&quot;)) {</span>
                        // a acabar
<span class="nc" id="L817">                        this.controller.finalizarCompra(currentUser);</span>
<span class="nc" id="L818">                        System.out.println(&quot;\nCompra concluída!&quot;);</span>
                    }

                    else {
                        break;
                    }

                    break;
                case 2:
<span class="nc" id="L827">                    System.out.println(&quot;Qual o código do artigo que pretende remover?&quot;);</span>
<span class="nc" id="L828">                    System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L829">                    Integer option_codigo = sc.nextInt();</span>

<span class="nc" id="L831">                    Integer r = this.controller.removeArtigoEncomenda(option_codigo, currentUser);</span>
<span class="nc bnc" id="L832" title="All 2 branches missed.">                    if (r == null) {</span>
<span class="nc" id="L833">                        System.out.println(&quot;\nArtigo com o código &quot; + option_codigo + &quot; não está na encomenda!&quot;);</span>
                    }
                    else {
<span class="nc" id="L836">                        this.controller.addArtigoEncomenda2(option_codigo);</span>
<span class="nc" id="L837">                        System.out.println(&quot;\nArtigo com o código &quot; + option_codigo + &quot; removido da encomenda!&quot;);</span>
                    }
                    break;
            }
        }
<span class="nc" id="L842">    }</span>

    private void showEstatisticasMenu() {
<span class="nc" id="L845">        System.out.println(&quot;\n0. Voltar\n1. O vendedor que mais facturou num período ou desde sempre\n2. A transportadora com o maior volume de facturação\n3. Lista de encomendas emitidas por um vendedor\n4. Lista ordenada dos maiores compradores/vendedores do sistema durante um período de tempo\n5. O dinheiro ganho pela Vintage&quot;);</span>
<span class="nc" id="L846">        System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L847">        int option = sc.nextInt();</span>
<span class="nc" id="L848">        sc.nextLine();</span>

<span class="nc bnc" id="L850" title="All 7 branches missed.">        switch (option) {</span>
            case 0:
<span class="nc" id="L852">                showLoggedInMenu();</span>
<span class="nc" id="L853">                break;</span>
            case 1:
<span class="nc" id="L855">                System.out.println(&quot;\n1. Desde sempre\n2. Num período de tempo&quot;);</span>
<span class="nc" id="L856">                System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L857">                int option44 = sc.nextInt();</span>
<span class="nc" id="L858">                sc.nextLine();</span>

<span class="nc bnc" id="L860" title="All 2 branches missed.">                if (option44 == 1) {</span>
<span class="nc" id="L861">                        String nome = this.controller.getMaiorVendedor();</span>
<span class="nc" id="L862">                        float valor = this.controller.getMaiorVendedorValor(nome);</span>

<span class="nc bnc" id="L864" title="All 2 branches missed.">                        if (valor == 0.0f) {</span>
<span class="nc" id="L865">                        System.out.println(&quot;\nAinda não houve vendas na Vintage, pelo que não é possível calcular o vendedor que mais facturou!&quot;);</span>
                        }
                        else {
<span class="nc" id="L868">                            System.out.println(&quot;\nO vendedor que mais facturou foi o &quot; + nome + &quot; e facturou um total de &quot; + valor + &quot;€!&quot;);</span>
                        }
<span class="nc" id="L870">                }</span>
                
<span class="nc bnc" id="L872" title="All 2 branches missed.">                else if (option44 == 2) {</span>
<span class="nc" id="L873">                        System.out.println(&quot;Indique a data inicial pretendida (yyyy-MM-dd HH)&quot;);</span>
<span class="nc" id="L874">                        System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L875">                        String date = sc.nextLine();</span>
<span class="nc" id="L876">                        DateTimeFormatter dateformatter = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH&quot;);</span>
<span class="nc" id="L877">                        LocalDateTime date1 = LocalDateTime.parse(date, dateformatter);</span>
<span class="nc" id="L878">                        System.out.println(&quot;Indique a data final pretendida (yyyy-MM-dd HH)&quot;);</span>
<span class="nc" id="L879">                        System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L880">                        date = sc.nextLine();</span>
<span class="nc" id="L881">                        LocalDateTime date2 = LocalDateTime.parse(date, dateformatter);</span>
<span class="nc" id="L882">                        Boolean booldate = date2.isAfter(date1);</span>
                
<span class="nc bnc" id="L884" title="All 2 branches missed.">                        if (booldate == false) {</span>
<span class="nc" id="L885">                            System.out.println(&quot;\nAs datas dadas são inválidas&quot;);</span>
                        }
                
                        else {
<span class="nc" id="L889">                            String nome3 = this.controller.getMaiorVendedorPeriodo(date1, date2);</span>
<span class="nc" id="L890">                            float valor3 = this.controller.getMaiorVendedorValorPeriodo(nome3, date1, date2);</span>
                        
<span class="nc bnc" id="L892" title="All 2 branches missed.">                            if (valor3 == 0.0f) {</span>
<span class="nc" id="L893">                            System.out.println(&quot;\nNão houve vendas na Vintage nesse período de tempo, pelo que não é possível calcular o vendedor que mais facturou!&quot;);</span>
                            }
                            else {
<span class="nc" id="L896">                                System.out.println(&quot;\nO vendedor que mais facturou foi o &quot; + nome3 + &quot; e facturou um total de &quot; + valor3 + &quot;€!&quot;);</span>
                            }
                        }
<span class="nc" id="L899">                    }</span>

                break;
            case 2:
<span class="nc" id="L903">                String nome2 = this.controller.getMaiorTransportadora();</span>
<span class="nc" id="L904">                float valor2 = this.controller.getMaiorTransportadoraValor(nome2);</span>

<span class="nc bnc" id="L906" title="All 2 branches missed.">                if (valor2 == 0.0f) {</span>
<span class="nc" id="L907">                    System.out.println(&quot;\nAinda não houve vendas na Vintage, pelo que não é possível calcular a transportadora que mais facturou!&quot;);</span>
                }
                else {
<span class="nc" id="L910">                    System.out.println(&quot;\nA transportadora que mais facturou foi a &quot; + nome2 + &quot; e facturou um total de &quot; + valor2 + &quot;€!&quot;);</span>
                }

<span class="nc" id="L913">                break;</span>
            case 3:
<span class="nc" id="L915">                System.out.println(&quot;Indique o nome do vendedor pretendido&quot;);</span>
<span class="nc" id="L916">                System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L917">                String user = sc.nextLine();</span>

<span class="nc" id="L919">                boolean check = this.controller.checkUtilizadorExiste(user);</span>
<span class="nc bnc" id="L920" title="All 2 branches missed.">                if (!check) {</span>
<span class="nc" id="L921">                    System.out.println(&quot;\nNão existe um vendedor com o nome indicado!&quot;);</span>
                }
                else {
<span class="nc" id="L924">                    String resultado = this.controller.getVendasUtilizador(user);</span>
                    
<span class="nc bnc" id="L926" title="All 2 branches missed.">                    if (!resultado.isEmpty()) {</span>
<span class="nc" id="L927">                        System.out.print(&quot;\n&quot;);</span>
<span class="nc" id="L928">                        System.out.println(resultado);</span>
                    }
                    else {
<span class="nc" id="L931">                        System.out.println(&quot;\nO vendedor indicado ainda não tem nenhuma venda!&quot;);</span>
                    }
                }
<span class="nc" id="L934">                break;</span>
            case 4:
<span class="nc" id="L936">                System.out.println(&quot;Indique a data inicial pretendida (yyyy-MM-dd HH)&quot;);</span>
<span class="nc" id="L937">                System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L938">                String date = sc.nextLine();</span>
<span class="nc" id="L939">                DateTimeFormatter dateformatter = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH&quot;);</span>
<span class="nc" id="L940">                LocalDateTime date1 = LocalDateTime.parse(date, dateformatter);</span>
<span class="nc" id="L941">                System.out.println(&quot;Indique a data final pretendida (yyyy-MM-dd HH)&quot;);</span>
<span class="nc" id="L942">                System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L943">                date = sc.nextLine();</span>
<span class="nc" id="L944">                LocalDateTime date2 = LocalDateTime.parse(date, dateformatter);</span>
<span class="nc" id="L945">                Boolean booldate = date2.isAfter(date1);</span>
                
<span class="nc bnc" id="L947" title="All 2 branches missed.">                if (booldate == false) {</span>
<span class="nc" id="L948">                    System.out.println(&quot;\nAs datas dadas são inválidas&quot;);</span>
                }
                
                else {
<span class="nc" id="L952">                    Map&lt;String, Integer&gt; result = this.controller.getListaMaioresVendedores(date1, date2);</span>

<span class="nc bnc" id="L954" title="All 2 branches missed.">                    for (Map.Entry&lt;String, Integer&gt; entry : result.entrySet()) {</span>
<span class="nc" id="L955">                        String vendedor = entry.getKey();</span>
<span class="nc" id="L956">                        Integer num = entry.getValue();</span>

<span class="nc bnc" id="L958" title="All 2 branches missed.">                        if (num &gt; 0) {</span>
<span class="nc" id="L959">                            System.out.println(&quot;\n&quot; + vendedor + &quot;: &quot; + num);</span>
                        }
<span class="nc" id="L961">                    }</span>
                }
<span class="nc" id="L963">                break;</span>
            case 5:
<span class="nc" id="L965">                float lucro = this.controller.getLucroVintage();</span>
<span class="nc" id="L966">                System.out.println(&quot;\nA Vintage ganhou, até agora, &quot; + lucro + &quot;€!&quot;);</span>
                break;
        }
<span class="nc" id="L969">    }</span>

    private String showStoreStateMenu() {
<span class="nc" id="L972">        System.out.println(&quot;Qual o nome do ficheiro onde pretende guardar o estado?&quot;);</span>
<span class="nc" id="L973">        System.out.print(&quot;&gt; &quot;);</span>
<span class="nc" id="L974">        String filename = &quot;input/&quot; + sc.nextLine();</span>

<span class="nc" id="L976">        return filename;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>