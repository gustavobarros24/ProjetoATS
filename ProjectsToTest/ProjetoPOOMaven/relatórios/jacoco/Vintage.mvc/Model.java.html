<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Model.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">ProjetoPOO</a> &gt; <a href="index.source.html" class="el_package">Vintage.mvc</a> &gt; <span class="el_source">Model.java</span></div><h1>Model.java</h1><pre class="source lang-java linenums">package Vintage.mvc;

import Vintage.qql.*;
import Vintage.qql.Encomenda.EstadoEncomenda;
import Vintage.qql.Encomenda.TamanhoEmbalagem;
import Vintage.qql.Fatura.Tipo;

import java.io.Serializable;
import java.time.LocalDateTime;
import java.time.temporal.ChronoUnit;
import java.util.*;

import static java.time.temporal.ChronoUnit.HOURS;

public class Model implements Serializable {
<span class="nc" id="L16">    public final float TAXA_DE_GARANTIA = 5.0f;</span>

    private LocalDateTime currentDateTime;
    private Map&lt;Integer, Artigo&gt; catalogoArtigos;
    private Map&lt;Integer, Artigo&gt; catalogoArtigosEncomenda;
    private Map&lt;Integer, Artigo&gt; artigosVendidos;
    private Map&lt;String, Utilizador&gt; catalogoUtilizadores;
    private Map&lt;String, Transportadora&gt; catalogoTransportadoras;
    private float lucro;

<span class="nc" id="L26">    public Model() {</span>
<span class="nc" id="L27">        this.catalogoArtigos = new HashMap&lt;&gt;();</span>
<span class="nc" id="L28">        this.catalogoArtigosEncomenda = new HashMap&lt;&gt;();</span>
<span class="nc" id="L29">        this.artigosVendidos = new HashMap&lt;&gt;();</span>
<span class="nc" id="L30">        this.catalogoUtilizadores = new HashMap&lt;&gt;();</span>
<span class="nc" id="L31">        this.catalogoTransportadoras = new HashMap&lt;&gt;();</span>
<span class="nc" id="L32">        this.lucro = 0.0f;</span>
<span class="nc" id="L33">        this.currentDateTime = LocalDateTime.now();</span>
<span class="nc" id="L34">    }</span>

<span class="nc" id="L36">    public Model(LocalDateTime currentDateTime, Map&lt;Integer, Artigo&gt; catalogoArtigos, Map&lt;Integer, Artigo&gt; catalogoArtigosEncomenda, Map&lt;Integer, Artigo&gt; artigosVendidos, Map&lt;String, Utilizador&gt; catalogoUtilizadores, Map&lt;String, Transportadora&gt; catalogoTransportadoras, float lucro) {</span>
<span class="nc" id="L37">        this.currentDateTime = currentDateTime;</span>

<span class="nc" id="L39">        this.catalogoArtigos = new HashMap&lt;&gt;();</span>
<span class="nc bnc" id="L40" title="All 2 branches missed.">        for (Integer codigo : catalogoArtigos.keySet()) {</span>
<span class="nc" id="L41">            Object obj = catalogoArtigos.get(codigo);</span>
<span class="nc bnc" id="L42" title="All 2 branches missed.">            if (obj instanceof Mala) {</span>
<span class="nc" id="L43">                this.catalogoArtigos.put(codigo, ((Mala) obj).clone());</span>
            //this.catalogoArtigos.put(codigo, catalogoArtigos.get(codigo).clone());
            }
<span class="nc bnc" id="L46" title="All 2 branches missed.">            else if (obj instanceof Sapatilha) {</span>
<span class="nc" id="L47">                this.catalogoArtigos.put(codigo, ((Sapatilha) obj).clone());</span>
            }
<span class="nc bnc" id="L49" title="All 2 branches missed.">            else if (obj instanceof TShirt) {</span>
<span class="nc" id="L50">                this.catalogoArtigos.put(codigo, ((TShirt) obj).clone());</span>
            }
<span class="nc" id="L52">        }</span>

<span class="nc" id="L54">        this.catalogoArtigosEncomenda = new HashMap&lt;&gt;();</span>
<span class="nc bnc" id="L55" title="All 2 branches missed.">        for (Integer codigo : catalogoArtigosEncomenda.keySet()) {</span>
            //this.catalogoArtigosEncomenda.put(codigo, catalogoArtigosEncomenda.get(codigo).clone());
<span class="nc" id="L57">            Object obj = catalogoArtigosEncomenda.get(codigo);</span>
<span class="nc bnc" id="L58" title="All 2 branches missed.">            if (obj instanceof Mala) {</span>
<span class="nc" id="L59">                this.catalogoArtigosEncomenda.put(codigo, ((Mala) obj).clone());</span>
            }
<span class="nc bnc" id="L61" title="All 2 branches missed.">            else if (obj instanceof Sapatilha) {</span>
<span class="nc" id="L62">                this.catalogoArtigosEncomenda.put(codigo, ((Sapatilha) obj).clone());</span>
            }
<span class="nc bnc" id="L64" title="All 2 branches missed.">            else if (obj instanceof TShirt) {</span>
<span class="nc" id="L65">                this.catalogoArtigosEncomenda.put(codigo, ((TShirt) obj).clone());</span>
            }
<span class="nc" id="L67">        }</span>

<span class="nc" id="L69">        this.artigosVendidos = new HashMap&lt;&gt;();</span>
<span class="nc bnc" id="L70" title="All 2 branches missed.">        for (Integer codigo : artigosVendidos.keySet()) {</span>
            //this.catalogoArtigosEncomenda.put(codigo, catalogoArtigosEncomenda.get(codigo).clone());
<span class="nc" id="L72">            Object obj = artigosVendidos.get(codigo);</span>
<span class="nc bnc" id="L73" title="All 2 branches missed.">            if (obj instanceof Mala) {</span>
<span class="nc" id="L74">                this.artigosVendidos.put(codigo, ((Mala) obj).clone());</span>
            }
<span class="nc bnc" id="L76" title="All 2 branches missed.">            else if (obj instanceof Sapatilha) {</span>
<span class="nc" id="L77">                this.artigosVendidos.put(codigo, ((Sapatilha) obj).clone());</span>
            }
<span class="nc bnc" id="L79" title="All 2 branches missed.">            else if (obj instanceof TShirt) {</span>
<span class="nc" id="L80">                this.artigosVendidos.put(codigo, ((TShirt) obj).clone());</span>
            }
<span class="nc" id="L82">        }</span>

<span class="nc" id="L84">        this.catalogoUtilizadores = new HashMap&lt;&gt;();</span>
<span class="nc bnc" id="L85" title="All 2 branches missed.">        for (String email : catalogoUtilizadores.keySet()) {</span>
<span class="nc" id="L86">            this.catalogoUtilizadores.put(email, catalogoUtilizadores.get(email).clone());</span>
<span class="nc" id="L87">        }</span>

<span class="nc" id="L89">        this.catalogoTransportadoras = new HashMap&lt;&gt;();</span>
<span class="nc bnc" id="L90" title="All 2 branches missed.">        for (String nome : catalogoTransportadoras.keySet()) {</span>
<span class="nc" id="L91">            this.catalogoTransportadoras.put(nome, catalogoTransportadoras.get(nome).clone());</span>
<span class="nc" id="L92">        }</span>

<span class="nc" id="L94">        this.lucro = lucro;</span>
<span class="nc" id="L95">    }</span>

<span class="nc" id="L97">    public Model(Model m) {</span>
<span class="nc" id="L98">        this.currentDateTime = m.getCurrentDateTime();</span>
<span class="nc" id="L99">        this.catalogoArtigos = m.getCatalogoArtigos();</span>
<span class="nc" id="L100">        this.catalogoArtigosEncomenda = m.getCatalogoArtigosEncomenda();</span>
<span class="nc" id="L101">        this.artigosVendidos = m.getArtigosVendidos();</span>
<span class="nc" id="L102">        this.catalogoUtilizadores = m.getCatalogoUtilizadores();</span>
<span class="nc" id="L103">        this.catalogoTransportadoras = m.getCatalogoTransportadoras();</span>
<span class="nc" id="L104">        this.lucro = m.getLucro();</span>
<span class="nc" id="L105">    }</span>

    public LocalDateTime getCurrentDateTime() {
<span class="nc" id="L108">        return currentDateTime;</span>
    }

    public Map&lt;Integer, Artigo&gt; getCatalogoArtigos() {
<span class="nc" id="L112">        Map&lt;Integer, Artigo&gt; catalogoArtigos = new HashMap&lt;&gt;();</span>
<span class="nc bnc" id="L113" title="All 2 branches missed.">        for (Integer codigo : this.catalogoArtigos.keySet()) {</span>
            //catalogoArtigos.put(codigo, this.catalogoArtigos.get(codigo).clone());
<span class="nc" id="L115">            Object obj = this.catalogoArtigos.get(codigo);</span>
<span class="nc bnc" id="L116" title="All 2 branches missed.">            if (obj instanceof Mala) {</span>
<span class="nc" id="L117">                catalogoArtigos.put(codigo, ((Mala) obj).clone());</span>
            }
<span class="nc bnc" id="L119" title="All 2 branches missed.">            else if (obj instanceof Sapatilha) {</span>
<span class="nc" id="L120">                catalogoArtigos.put(codigo, ((Sapatilha) obj).clone());</span>
            }
<span class="nc bnc" id="L122" title="All 2 branches missed.">            else if (obj instanceof TShirt) {</span>
<span class="nc" id="L123">                catalogoArtigos.put(codigo, ((TShirt) obj).clone());</span>
            }
<span class="nc" id="L125">        }</span>
<span class="nc" id="L126">        return catalogoArtigos;</span>
    }

    public Map&lt;Integer, Artigo&gt; getCatalogoArtigosEncomenda() {
<span class="nc" id="L130">        Map&lt;Integer, Artigo&gt; catalogoArtigosEncomenda = new HashMap&lt;&gt;();</span>
<span class="nc bnc" id="L131" title="All 2 branches missed.">        for (Integer codigo : this.catalogoArtigosEncomenda.keySet()) {</span>
            //catalogoArtigosEncomenda.put(codigo, this.catalogoArtigosEncomenda.get(codigo).clone());
<span class="nc" id="L133">            Object obj = this.catalogoArtigosEncomenda.get(codigo);</span>
<span class="nc bnc" id="L134" title="All 2 branches missed.">            if (obj instanceof Mala) {</span>
<span class="nc" id="L135">                catalogoArtigosEncomenda.put(codigo, ((Mala) obj).clone());</span>
            }
<span class="nc bnc" id="L137" title="All 2 branches missed.">            else if (obj instanceof Sapatilha) {</span>
<span class="nc" id="L138">                catalogoArtigosEncomenda.put(codigo, ((Sapatilha) obj).clone());</span>
            }
<span class="nc bnc" id="L140" title="All 2 branches missed.">            else if (obj instanceof TShirt) {</span>
<span class="nc" id="L141">                catalogoArtigosEncomenda.put(codigo, ((TShirt) obj).clone());</span>
            }
<span class="nc" id="L143">        }</span>
<span class="nc" id="L144">        return catalogoArtigosEncomenda;</span>
    }

    public Map&lt;Integer, Artigo&gt; getArtigosVendidos() {
<span class="nc" id="L148">        Map&lt;Integer, Artigo&gt; artigosVendidos = new HashMap&lt;&gt;();</span>
<span class="nc bnc" id="L149" title="All 2 branches missed.">        for (Integer codigo : this.artigosVendidos.keySet()) {</span>
            //catalogoArtigosEncomenda.put(codigo, this.catalogoArtigosEncomenda.get(codigo).clone());
<span class="nc" id="L151">            Object obj = this.artigosVendidos.get(codigo);</span>
<span class="nc bnc" id="L152" title="All 2 branches missed.">            if (obj instanceof Mala) {</span>
<span class="nc" id="L153">                artigosVendidos.put(codigo, ((Mala) obj).clone());</span>
            }
<span class="nc bnc" id="L155" title="All 2 branches missed.">            else if (obj instanceof Sapatilha) {</span>
<span class="nc" id="L156">                artigosVendidos.put(codigo, ((Sapatilha) obj).clone());</span>
            }
<span class="nc bnc" id="L158" title="All 2 branches missed.">            else if (obj instanceof TShirt) {</span>
<span class="nc" id="L159">                artigosVendidos.put(codigo, ((TShirt) obj).clone());</span>
            }
<span class="nc" id="L161">        }</span>
<span class="nc" id="L162">        return artigosVendidos;</span>
    }

    public Map&lt;String, Utilizador&gt; getCatalogoUtilizadores() {
<span class="nc" id="L166">        Map&lt;String, Utilizador&gt; catalogoUtilizadores = new HashMap&lt;&gt;();</span>
<span class="nc bnc" id="L167" title="All 2 branches missed.">        for (String email : this.catalogoUtilizadores.keySet()) {</span>
<span class="nc" id="L168">            catalogoUtilizadores.put(email, this.catalogoUtilizadores.get(email).clone());</span>
<span class="nc" id="L169">        }</span>
<span class="nc" id="L170">        return catalogoUtilizadores;</span>
    }

    public Map&lt;String, Transportadora&gt; getCatalogoTransportadoras() {
<span class="nc" id="L174">        Map&lt;String, Transportadora&gt; catalogoTransportadoras = new HashMap&lt;&gt;();</span>
<span class="nc bnc" id="L175" title="All 2 branches missed.">        for (String nome : this.catalogoTransportadoras.keySet()) {</span>
<span class="nc" id="L176">            catalogoTransportadoras.put(nome, this.catalogoTransportadoras.get(nome).clone());</span>
<span class="nc" id="L177">        }</span>
<span class="nc" id="L178">        return catalogoTransportadoras;</span>
    }

    public float getLucro() {
<span class="nc" id="L182">        return lucro;</span>
    }

    public void setCurrentDate(LocalDateTime currentDateTime) {
<span class="nc" id="L186">        this.currentDateTime = currentDateTime;</span>
<span class="nc" id="L187">    }</span>

    public void setCatalogoArtigos(Map&lt;Integer, Artigo&gt; catalogoArtigos) {
<span class="nc" id="L190">        Map&lt;Integer, Artigo&gt; novoCatalogoArtigos = new HashMap&lt;Integer, Artigo&gt;();</span>
<span class="nc bnc" id="L191" title="All 2 branches missed.">        for (Integer codigo : catalogoArtigos.keySet()) {</span>
            //novoCatalogoArtigos.put(codigo, catalogoArtigos.get(codigo).clone());
<span class="nc" id="L193">            Object obj = catalogoArtigos.get(codigo);</span>
<span class="nc bnc" id="L194" title="All 2 branches missed.">            if (obj instanceof Mala) {</span>
<span class="nc" id="L195">                novoCatalogoArtigos.put(codigo, ((Mala) obj).clone());</span>
            }
<span class="nc bnc" id="L197" title="All 2 branches missed.">            else if (obj instanceof Sapatilha) {</span>
<span class="nc" id="L198">                novoCatalogoArtigos.put(codigo, ((Sapatilha) obj).clone());</span>
            }
<span class="nc bnc" id="L200" title="All 2 branches missed.">            else if (obj instanceof TShirt) {</span>
<span class="nc" id="L201">                novoCatalogoArtigos.put(codigo, ((TShirt) obj).clone());</span>
            }
<span class="nc" id="L203">        }</span>
<span class="nc" id="L204">        this.catalogoArtigos = novoCatalogoArtigos;</span>
<span class="nc" id="L205">    }</span>

    public void setCatalogoArtigosEncomenda(Map&lt;Integer, Artigo&gt; catalogoArtigosEncomenda) {
<span class="nc" id="L208">        Map&lt;Integer, Artigo&gt; novoCatalogoArtigosEncomenda = new HashMap&lt;Integer, Artigo&gt;();</span>
<span class="nc bnc" id="L209" title="All 2 branches missed.">        for (Integer codigo : catalogoArtigosEncomenda.keySet()) {</span>
            //novoCatalogoArtigosEncomenda.put(codigo, catalogoArtigosEncomenda.get(codigo).clone());
<span class="nc" id="L211">            Object obj = catalogoArtigosEncomenda.get(codigo);</span>
<span class="nc bnc" id="L212" title="All 2 branches missed.">            if (obj instanceof Mala) {</span>
<span class="nc" id="L213">                novoCatalogoArtigosEncomenda.put(codigo, ((Mala) obj).clone());</span>
            }
<span class="nc bnc" id="L215" title="All 2 branches missed.">            else if (obj instanceof Sapatilha) {</span>
<span class="nc" id="L216">                novoCatalogoArtigosEncomenda.put(codigo, ((Sapatilha) obj).clone());</span>
            }
<span class="nc bnc" id="L218" title="All 2 branches missed.">            else if (obj instanceof TShirt) {</span>
<span class="nc" id="L219">                novoCatalogoArtigosEncomenda.put(codigo, ((TShirt) obj).clone());</span>
            }
<span class="nc" id="L221">        }</span>
<span class="nc" id="L222">        this.catalogoArtigosEncomenda = novoCatalogoArtigosEncomenda;</span>
<span class="nc" id="L223">    }</span>

    public void setArtigosVendidos(Map&lt;Integer, Artigo&gt; artigosVendidos) {
<span class="nc" id="L226">        Map&lt;Integer, Artigo&gt; novoArtigosVendidos = new HashMap&lt;Integer, Artigo&gt;();</span>
<span class="nc bnc" id="L227" title="All 2 branches missed.">        for (Integer codigo : artigosVendidos.keySet()) {</span>
            //novoCatalogoArtigosEncomenda.put(codigo, catalogoArtigosEncomenda.get(codigo).clone());
<span class="nc" id="L229">            Object obj = artigosVendidos.get(codigo);</span>
<span class="nc bnc" id="L230" title="All 2 branches missed.">            if (obj instanceof Mala) {</span>
<span class="nc" id="L231">                novoArtigosVendidos.put(codigo, ((Mala) obj).clone());</span>
            }
<span class="nc bnc" id="L233" title="All 2 branches missed.">            else if (obj instanceof Sapatilha) {</span>
<span class="nc" id="L234">                novoArtigosVendidos.put(codigo, ((Sapatilha) obj).clone());</span>
            }
<span class="nc bnc" id="L236" title="All 2 branches missed.">            else if (obj instanceof TShirt) {</span>
<span class="nc" id="L237">                novoArtigosVendidos.put(codigo, ((TShirt) obj).clone());</span>
            }
<span class="nc" id="L239">        }</span>
<span class="nc" id="L240">        this.artigosVendidos = novoArtigosVendidos;</span>
<span class="nc" id="L241">    }</span>

    public void setCatalogoUtilizadores(Map&lt;String, Utilizador&gt; catalogoUtilizadores) {
<span class="nc" id="L244">        Map&lt;String, Utilizador&gt; novoCatalogoUtilizadores = new HashMap&lt;String, Utilizador&gt;();</span>
<span class="nc bnc" id="L245" title="All 2 branches missed.">        for (String email : catalogoUtilizadores.keySet()) {</span>
<span class="nc" id="L246">            novoCatalogoUtilizadores.put(email, catalogoUtilizadores.get(email).clone());</span>
<span class="nc" id="L247">        }</span>
<span class="nc" id="L248">        this.catalogoUtilizadores = novoCatalogoUtilizadores;</span>
<span class="nc" id="L249">    }</span>

    public void setCatalogoTransportadoras(Map&lt;String, Transportadora&gt; catalogoTransportadoras) {
<span class="nc" id="L252">        Map&lt;String, Transportadora&gt; novoCatalogoTransportadoras = new HashMap&lt;String, Transportadora&gt;();</span>
<span class="nc bnc" id="L253" title="All 2 branches missed.">        for (String nome : catalogoTransportadoras.keySet()) {</span>
<span class="nc" id="L254">            novoCatalogoTransportadoras.put(nome, catalogoTransportadoras.get(nome).clone());</span>
<span class="nc" id="L255">        }</span>
<span class="nc" id="L256">        this.catalogoTransportadoras = novoCatalogoTransportadoras;</span>
<span class="nc" id="L257">    }</span>

    public void setLucro(float lucro) {
<span class="nc" id="L260">        this.lucro = lucro;</span>
<span class="nc" id="L261">    }</span>

    public String addUtilizador(Utilizador u) {
<span class="nc bnc" id="L264" title="All 2 branches missed.">        if (catalogoUtilizadores.containsKey(u.getEmail())) {</span>
<span class="nc" id="L265">            throw new IllegalArgumentException(&quot;\nUtilizador já existe! Tente novamente.&quot;);</span>
        } 
        else {
<span class="nc" id="L268">            this.catalogoUtilizadores.put(u.getEmail(), u.clone());</span>
<span class="nc" id="L269">            return u.getEmail();</span>
        }
    }

    public String addTransportadora(Transportadora t) {
<span class="nc bnc" id="L274" title="All 2 branches missed.">        if (catalogoTransportadoras.containsKey(t.getNome())) {</span>
<span class="nc" id="L275">            throw new IllegalArgumentException(&quot;\nTransportadora já existe! Tente novamente.&quot;);</span>
        }
        else {
<span class="nc" id="L278">            this.catalogoTransportadoras.put(t.getNome(), t.clone());</span>
<span class="nc" id="L279">            return t.getNome();</span>
        }
    }

    public String addArtigo(Artigo a) {
<span class="nc bnc" id="L284" title="All 2 branches missed.">        if (!catalogoArtigos.containsKey(a.getCodigo())) {</span>
            //this.catalogoArtigos.put(a.getCodigo(), a.clone());
<span class="nc" id="L286">            Object obj = this.catalogoArtigos.get(a.getCodigo());</span>
<span class="nc bnc" id="L287" title="All 2 branches missed.">            if (obj instanceof Mala) {</span>
<span class="nc" id="L288">                this.catalogoArtigos.put(a.getCodigo(), ((Mala) obj).clone());</span>
            }
<span class="nc bnc" id="L290" title="All 2 branches missed.">            else if (obj instanceof Sapatilha) {</span>
<span class="nc" id="L291">                this.catalogoArtigos.put(a.getCodigo(), ((Sapatilha) obj).clone());</span>
            }
<span class="nc bnc" id="L293" title="All 2 branches missed.">            else if (obj instanceof TShirt) {</span>
<span class="nc" id="L294">                this.catalogoArtigos.put(a.getCodigo(), ((TShirt) obj).clone());</span>
            }

<span class="nc" id="L297">            return a.getNome();</span>
        }
        else {
<span class="nc" id="L300">            return &quot;null&quot;;</span>
        }
    }

    public String addMala(Mala a, String currentUser) {
<span class="nc bnc" id="L305" title="All 2 branches missed.">        if (!catalogoArtigos.containsKey(a.getCodigo())) {</span>
<span class="nc" id="L306">            Utilizador tmp_usr = catalogoUtilizadores.get(currentUser);</span>
<span class="nc" id="L307">            tmp_usr.addArtigoProdutosAVenda(a.getCodigo(), a);</span>

<span class="nc" id="L309">            this.catalogoArtigos.put(a.getCodigo(), a.clone());</span>
<span class="nc" id="L310">            return a.getNome();</span>
        }
        else {
<span class="nc" id="L313">            return &quot;null&quot;;</span>
        }
    }

    public String addSapatilha(Sapatilha a, String currentUser) {
<span class="nc bnc" id="L318" title="All 2 branches missed.">        if (!catalogoArtigos.containsKey(a.getCodigo())) {</span>
<span class="nc" id="L319">            Utilizador tmp_usr = catalogoUtilizadores.get(currentUser);</span>
<span class="nc" id="L320">            tmp_usr.addArtigoProdutosAVenda(a.getCodigo(), a);</span>
            
<span class="nc" id="L322">            this.catalogoArtigos.put(a.getCodigo(), a.clone());</span>
<span class="nc" id="L323">            return a.getNome();</span>
        }
        else {
<span class="nc" id="L326">            return &quot;null&quot;;</span>
        }
    }

    public String addTShirt(TShirt a, String currentUser) {
<span class="nc bnc" id="L331" title="All 2 branches missed.">        if (!catalogoArtigos.containsKey(a.getCodigo())) {</span>
<span class="nc" id="L332">            Utilizador tmp_usr = catalogoUtilizadores.get(currentUser);</span>
<span class="nc" id="L333">            tmp_usr.addArtigoProdutosAVenda(a.getCodigo(), a);</span>
            
<span class="nc" id="L335">            this.catalogoArtigos.put(a.getCodigo(), a.clone());</span>
<span class="nc" id="L336">            return a.getNome();</span>
        }
        else {
<span class="nc" id="L339">            return &quot;null&quot;;</span>
        }
    }
    
    public String showArtigos() {
<span class="nc" id="L344">        StringBuilder sb = new StringBuilder();</span>
<span class="nc" id="L345">        Iterator&lt;Artigo&gt; it = this.catalogoArtigos.values().iterator();</span>

<span class="nc bnc" id="L347" title="All 2 branches missed.">        while (it.hasNext()) {</span>
<span class="nc" id="L348">            Artigo artigo = it.next();</span>
            //sb.append(artigo + &quot;\n&quot;);
<span class="nc" id="L350">            sb.append(artigo);</span>
<span class="nc" id="L351">            sb.append(&quot;, stock: &quot; + artigo.getStock() + &quot;\n&quot;);</span>
<span class="nc" id="L352">        }</span>

<span class="nc" id="L354">        return sb.toString();</span>
    }

    public String showTransportadoras() {
<span class="nc" id="L358">        StringBuilder sb = new StringBuilder();</span>
<span class="nc" id="L359">        Iterator&lt;Transportadora&gt; it = this.catalogoTransportadoras.values().iterator();</span>

<span class="nc bnc" id="L361" title="All 2 branches missed.">        while (it.hasNext()) {</span>
<span class="nc" id="L362">            Transportadora transportadora = it.next();</span>
<span class="nc" id="L363">            System.out.println(transportadora.getNome());</span>
<span class="nc" id="L364">            sb.append(&quot; - &quot; + transportadora.getNome() + &quot;\n&quot;);</span>
<span class="nc" id="L365">        }</span>

<span class="nc" id="L367">        return sb.toString();</span>
    }

    public int getNumArtigos() {
<span class="nc" id="L371">        return catalogoArtigos.size();</span>
    }

    public int getNumTransportadoras() {
<span class="nc" id="L375">        return catalogoTransportadoras.size();</span>
    }

    public Integer addArtigoEncomenda(Integer option_codigo, Integer option_stock, String currentUser) {
<span class="nc bnc" id="L379" title="All 2 branches missed.">        if (catalogoArtigos.containsKey(option_codigo)) {</span>
<span class="nc" id="L380">            Artigo tmp_art = catalogoArtigos.get(option_codigo);</span>
<span class="nc" id="L381">            int tmp_art_stock = tmp_art.getStock();</span>

<span class="nc bnc" id="L383" title="All 4 branches missed.">            if (tmp_art_stock &lt; option_stock || option_stock &lt;= 0) {</span>
<span class="nc" id="L384">                return -1;</span>
            }
            else {
<span class="nc" id="L387">                Utilizador tmp = catalogoUtilizadores.get(currentUser);</span>
<span class="nc" id="L388">                Integer r = tmp.addArtigoEncomenda(option_codigo, option_stock);</span>

<span class="nc" id="L390">                catalogoArtigosEncomenda.put(option_codigo, tmp_art);</span>

<span class="nc bnc" id="L392" title="All 2 branches missed.">                if (tmp_art_stock == option_stock) {</span>
<span class="nc" id="L393">                    catalogoArtigos.remove(option_codigo);</span>
                }
                else {
<span class="nc" id="L396">                    tmp_art.setStock(tmp_art_stock - option_stock);</span>
                }

<span class="nc" id="L399">                return r;</span>
            }
        }
        else {
<span class="nc" id="L403">            return 0;</span>
        }
    }

    public void addArtigoEncomenda2(Integer option_codigo) {
<span class="nc" id="L408">        Artigo tmp_art = catalogoArtigosEncomenda.get(option_codigo);</span>
<span class="nc" id="L409">        catalogoArtigos.put(option_codigo, tmp_art);</span>
<span class="nc" id="L410">        catalogoArtigosEncomenda.remove(option_codigo);</span>
<span class="nc" id="L411">    }</span>

    public Integer removeArtigoEncomenda(Integer option_codigo, String currentUser) {
<span class="nc" id="L414">        Utilizador tmp = catalogoUtilizadores.get(currentUser);</span>
<span class="nc" id="L415">        return tmp.removeArtigoEncomenda(option_codigo);</span>
    }

    public String showEncomenda(String currentUser) {
<span class="nc" id="L419">        Utilizador tmp_usr = catalogoUtilizadores.get(currentUser);</span>
<span class="nc" id="L420">        Encomenda tmp_enc = tmp_usr.getEncomenda();</span>
        
<span class="nc bnc" id="L422" title="All 2 branches missed.">        if (tmp_enc != null) {</span>
<span class="nc" id="L423">            Map&lt;Integer, Integer&gt; artigosEnc = tmp_enc.getArtigos();</span>
        
<span class="nc bnc" id="L425" title="All 2 branches missed.">            if (artigosEnc.size() &gt; 0) {</span>
<span class="nc" id="L426">                StringBuilder sb = new StringBuilder();</span>
<span class="nc" id="L427">                sb.append(&quot;\n&quot;);</span>
<span class="nc bnc" id="L428" title="All 2 branches missed.">                for (Integer key : artigosEnc.keySet()) {</span>
<span class="nc bnc" id="L429" title="All 2 branches missed.">                    if (catalogoArtigosEncomenda.containsKey(key)) {</span>
<span class="nc" id="L430">                        Artigo artigo = catalogoArtigosEncomenda.get(key);</span>
<span class="nc" id="L431">                        sb.append(artigo.toString());</span>
<span class="nc" id="L432">                        sb.append(&quot;, stock: &quot; + artigosEnc.get(key));</span>
<span class="nc" id="L433">                        sb.append(&quot;\n&quot;);</span>
                    }
<span class="nc" id="L435">                }</span>
    
<span class="nc" id="L437">                return sb.toString();</span>
            }
            else {
<span class="nc" id="L440">                return &quot;\nSem artigos na encomenda!&quot;;</span>
            }
        }
        else {
<span class="nc" id="L444">            return &quot;\nSem artigos na encomenda!&quot;;</span>
        }
    }

   public String showEncomendasFeitas(String currentUser) {
<span class="nc" id="L449">       Utilizador tmp_usr = catalogoUtilizadores.get(currentUser);</span>
<span class="nc" id="L450">       Map&lt;Integer, Encomenda&gt; encFeitas = tmp_usr.getEncomendasFeitas();</span>

<span class="nc" id="L452">       StringBuilder sb = new StringBuilder();</span>
<span class="nc" id="L453">       sb.append(&quot;\n&quot;);</span>

<span class="nc bnc" id="L455" title="All 2 branches missed.">       for (Integer codigo : encFeitas.keySet()) {</span>
<span class="nc" id="L456">           Encomenda encomenda = encFeitas.get(codigo);</span>
<span class="nc" id="L457">           sb.append(encomenda.toString());</span>
<span class="nc" id="L458">           sb.append(&quot;\n&quot;);</span>
<span class="nc" id="L459">       }</span>

<span class="nc" id="L461">       return sb.toString();</span>
   }

    public boolean checkUtilizadorExiste(String email) {
<span class="nc" id="L465">        return catalogoUtilizadores.containsKey(email);</span>
    }

    public boolean checkTransportadoraExiste(String nome) {
<span class="nc" id="L469">        return catalogoTransportadoras.containsKey(nome);</span>
    }

    public boolean checkEncomendaVazia(String nome) {
<span class="nc" id="L473">        Utilizador tmp_usr = catalogoUtilizadores.get(nome);</span>
<span class="nc bnc" id="L474" title="All 2 branches missed.">        if (tmp_usr.getEncomenda() == null) {</span>
<span class="nc" id="L475">            return true;</span>
        }
        else {
<span class="nc" id="L478">            return false;</span>
        }
    }

    public boolean checkUtilizadorEncADevolver(String nome) {
<span class="nc" id="L483">        Utilizador tmp_usr = catalogoUtilizadores.get(nome);</span>
<span class="nc" id="L484">        Map&lt;Integer, Encomenda&gt; encFeitas = tmp_usr.getEncomendasFeitas();</span>

        boolean r;

<span class="nc bnc" id="L488" title="All 2 branches missed.">        if (encFeitas.isEmpty()) {</span>
<span class="nc" id="L489">            r = false;</span>
        }

        else {
<span class="nc" id="L493">            r = false;</span>

<span class="nc bnc" id="L495" title="All 2 branches missed.">            for (Integer codigo : encFeitas.keySet()) {</span>
<span class="nc" id="L496">                Encomenda encomenda = encFeitas.get(codigo);</span>
<span class="nc" id="L497">                LocalDateTime dataEnc = encomenda.getDataCriacao();</span>
<span class="nc" id="L498">                LocalDateTime dataCurr = getCurrentDateTime();</span>
<span class="nc" id="L499">                long hours = HOURS.between(dataEnc, dataCurr);</span>
                
<span class="nc bnc" id="L501" title="All 2 branches missed.">                if (hours &lt; 49) {</span>
<span class="nc" id="L502">                    r = true;</span>
                }
<span class="nc" id="L504">            }</span>

        }

<span class="nc" id="L508">        return r;</span>
    }

    public boolean checkUtilizadorTemFaturas(String nome) {
<span class="nc" id="L512">        Utilizador tmp_usr = catalogoUtilizadores.get(nome);</span>
<span class="nc" id="L513">        List&lt;Fatura&gt; faturas = tmp_usr.getFaturas();</span>

<span class="nc bnc" id="L515" title="All 2 branches missed.">        if (faturas.isEmpty()) {</span>
<span class="nc" id="L516">            return false;</span>
        }
        else {
<span class="nc" id="L519">            return true;</span>
        }
    }

    public boolean checkUtilizadorTemEncADevolver(Integer codigo, String nome) {
<span class="nc" id="L524">        Utilizador tmp_usr = catalogoUtilizadores.get(nome);</span>
<span class="nc" id="L525">        Map&lt;Integer, Encomenda&gt; encFeitas = tmp_usr.getEncomendasFeitas();</span>

<span class="nc bnc" id="L527" title="All 2 branches missed.">        if (encFeitas.containsKey(codigo)) {</span>
<span class="nc" id="L528">            return true;</span>
        }
        else {
<span class="nc" id="L531">            return false;</span>
        }
    }

    public void initEncomendaUser(String nome) {
<span class="nc" id="L536">        Utilizador tmp_usr = catalogoUtilizadores.get(nome);</span>
<span class="nc" id="L537">        tmp_usr.setEncomenda();</span>
<span class="nc" id="L538">    }</span>

    public float calcularPrecoFinalEncomenda(String nome) {
<span class="nc" id="L541">        Utilizador tmp_usr = catalogoUtilizadores.get(nome);</span>
<span class="nc" id="L542">        Encomenda tmp_enc = tmp_usr.getEncomenda();</span>

<span class="nc" id="L544">        Map&lt;Integer, Integer&gt; artigos = tmp_enc.getArtigos();</span>
<span class="nc" id="L545">        float preco = 0.0f;</span>
<span class="nc" id="L546">        float custoExpedicao = 0.0f;</span>

<span class="nc" id="L548">        int artNovos = 0;</span>
<span class="nc" id="L549">        int artUsados = 0;</span>
<span class="nc bnc" id="L550" title="All 2 branches missed.">        for (Integer codigo : artigos.keySet()) {</span>
<span class="nc" id="L551">            Artigo tmp_art = catalogoArtigosEncomenda.get(codigo);</span>
<span class="nc" id="L552">            Integer stock = artigos.get(codigo);</span>
<span class="nc" id="L553">            preco += tmp_art.calcularPrecoFinal() * stock;</span>

<span class="nc bnc" id="L555" title="All 2 branches missed.">            if (tmp_art.getNovo()) {</span>
<span class="nc" id="L556">                artNovos++;</span>
            }
            else {
<span class="nc" id="L559">                artUsados++;</span>
            }

<span class="nc" id="L562">            Transportadora tmp_trans = catalogoTransportadoras.get(tmp_art.getTransportadora());</span>
<span class="nc" id="L563">            float custoExpedicao_tmp = tmp_trans.calculaPrecoExpedicao(tmp_enc.getTamanhoEmbalagem());</span>
<span class="nc" id="L564">            tmp_trans.setLucroEfetivo(custoExpedicao_tmp);</span>
<span class="nc" id="L565">            tmp_art.setCustosExpedicao(custoExpedicao_tmp);</span>
<span class="nc" id="L566">            custoExpedicao += custoExpedicao_tmp;</span>
<span class="nc" id="L567">        }</span>

<span class="nc" id="L569">        preco += custoExpedicao;</span>

<span class="nc" id="L571">        float taxas = artNovos * tmp_enc.TAXA_SATISFACAO_ARTIGO_NOVO + artUsados * tmp_enc.TAXA_SATISFACAO_ARTIGO_USADO;</span>
<span class="nc" id="L572">        preco += taxas;</span>

<span class="nc" id="L574">        preco += this.TAXA_DE_GARANTIA;</span>
<span class="nc" id="L575">        this.lucro += this.TAXA_DE_GARANTIA;</span>

<span class="nc" id="L577">        tmp_enc.setTamanhoEmbalagem();</span>
<span class="nc" id="L578">        TamanhoEmbalagem tamanho = tmp_enc.getTamanhoEmbalagem();</span>
        //tmp_trans = catalogoTransportadoras.get()
        //preco += tmp_enc.calculaPrecoExpedicao(tamanho);
        //tmp_enc.setEstado(EstadoEncomenda.FINALIZADA);
<span class="nc" id="L582">        tmp_enc.setPrecoFinal(preco);</span>

<span class="nc" id="L584">        return preco;</span>
    }

    public void finalizarCompra(String nome) {
<span class="nc" id="L588">        Utilizador tmp_usr = catalogoUtilizadores.get(nome);</span>
<span class="nc" id="L589">        Encomenda tmp_enc = tmp_usr.getEncomenda();</span>
<span class="nc" id="L590">        Map&lt;Integer, Integer&gt; artigos = tmp_enc.getArtigos();</span>

<span class="nc bnc" id="L592" title="All 2 branches missed.">        for (Integer codigo : artigos.keySet()) {</span>
<span class="nc" id="L593">            Artigo tmp_art = catalogoArtigosEncomenda.get(codigo);</span>
<span class="nc" id="L594">            Utilizador vendedor = catalogoUtilizadores.get(tmp_art.getVendedor());</span>

<span class="nc" id="L596">            artigosVendidos.put(codigo, tmp_art);</span>
<span class="nc" id="L597">            catalogoArtigosEncomenda.remove(codigo);</span>
            
<span class="nc" id="L599">            Integer stock = artigos.get(codigo);</span>
<span class="nc" id="L600">            vendedor.addArtigoProdutosVendidos(codigo, tmp_art, stock);</span>
<span class="nc" id="L601">            vendedor.removeArtigoProdutosAVenda(codigo);</span>
<span class="nc" id="L602">        }</span>

<span class="nc" id="L604">        tmp_usr.addEncomendaEncomendasFeitas(tmp_enc.getCodigo(), tmp_enc);</span>

<span class="nc" id="L606">        tmp_enc.setEstado(EstadoEncomenda.EXPEDIDA);</span>
<span class="nc" id="L607">        LocalDateTime dataPrevista = currentDateTime.plusDays((long) (Math.random() * 9) + 2);</span>
<span class="nc" id="L608">        tmp_enc.setDataPrevistaEntrega(dataPrevista);</span>

<span class="nc" id="L610">        tmp_usr.setEncomendaNull();</span>
<span class="nc" id="L611">    }</span>

    public void devolverEncomenda(String nome, Integer codigo_enc) {
<span class="nc" id="L614">        Utilizador tmp_usr = catalogoUtilizadores.get(nome);</span>
<span class="nc" id="L615">        Map&lt;Integer, Encomenda&gt; encFeitas = tmp_usr.getEncomendasFeitas();</span>
<span class="nc" id="L616">        Encomenda encomenda = encFeitas.get(codigo_enc);</span>

<span class="nc" id="L618">        Map&lt;Integer, Integer&gt; artigos = encomenda.getArtigos();</span>

<span class="nc bnc" id="L620" title="All 2 branches missed.">        for (Integer codigo : artigos.keySet()) {</span>
<span class="nc" id="L621">            Artigo tmp_art = artigosVendidos.get(codigo);</span>
<span class="nc" id="L622">            Utilizador vendedor = catalogoUtilizadores.get(tmp_art.getVendedor());</span>

<span class="nc" id="L624">            vendedor.removeArtigoProdutosVendidos(codigo);</span>
<span class="nc" id="L625">            vendedor.addArtigoProdutosAVenda(codigo, tmp_art);</span>

<span class="nc bnc" id="L627" title="All 2 branches missed.">            if (!catalogoArtigos.containsKey(codigo)) {</span>
<span class="nc" id="L628">                catalogoArtigos.put(codigo, tmp_art);</span>
            }
            else {
<span class="nc" id="L631">                int stock_comprado = artigos.get(codigo);</span>
<span class="nc" id="L632">                int stock_existente = tmp_art.getStock();</span>
<span class="nc" id="L633">                tmp_art.setStock(stock_comprado + stock_existente);</span>
<span class="nc" id="L634">                catalogoArtigos.put(codigo, tmp_art);</span>
            }
<span class="nc" id="L636">        }</span>

<span class="nc" id="L638">        tmp_usr.removeEncomendaEncomendasFeitas(codigo_enc);</span>
<span class="nc" id="L639">        encomenda.setEstado(EstadoEncomenda.DEVOLVIDA);</span>
<span class="nc" id="L640">    }</span>

    public String getVendasUtilizador(String nome) {
<span class="nc" id="L643">        Utilizador tmp_usr = catalogoUtilizadores.get(nome);</span>
        
<span class="nc" id="L645">        StringBuilder sb = new StringBuilder();</span>
<span class="nc" id="L646">        Iterator&lt;Artigo&gt; it = tmp_usr.getProdutosVendidos().values().iterator();</span>

<span class="nc bnc" id="L648" title="All 2 branches missed.">        while (it.hasNext()) {</span>
<span class="nc" id="L649">            Artigo artigo = it.next();</span>
<span class="nc" id="L650">            sb.append(artigo + &quot;\n&quot;);</span>
<span class="nc" id="L651">        }</span>

<span class="nc" id="L653">        return sb.toString();</span>
   }

   public String getMaiorVendedor() {
<span class="nc" id="L657">        Utilizador maiorVendedor = null;</span>
<span class="nc" id="L658">        float maiorValor = -1.0f;</span>

<span class="nc bnc" id="L660" title="All 2 branches missed.">        for (Utilizador vendedor : catalogoUtilizadores.values()) {</span>
<span class="nc" id="L661">            float valor = vendedor.getTotalVendas();</span>

<span class="nc bnc" id="L663" title="All 2 branches missed.">            if (valor &gt; maiorValor) {</span>
<span class="nc" id="L664">                maiorValor = valor;</span>
<span class="nc" id="L665">                maiorVendedor = vendedor;</span>
            }
<span class="nc" id="L667">        }</span>

<span class="nc" id="L669">        return maiorVendedor.getEmail();</span>
   }

    public String getMaiorVendedorPeriodo(LocalDateTime date1, LocalDateTime date2) {
<span class="nc" id="L673">        Utilizador maiorVendedor = null;</span>
<span class="nc" id="L674">        float maiorValor = -1.0f;</span>

<span class="nc bnc" id="L676" title="All 2 branches missed.">        for (Utilizador vendedor : catalogoUtilizadores.values()) {</span>
<span class="nc" id="L677">            float valor = vendedor.getTotalVendasPeriodo(date1, date2);</span>

<span class="nc bnc" id="L679" title="All 2 branches missed.">            if (valor &gt; maiorValor) {</span>
<span class="nc" id="L680">                maiorValor = valor;</span>
<span class="nc" id="L681">                maiorVendedor = vendedor;</span>
            }
<span class="nc" id="L683">        }</span>

<span class="nc" id="L685">        return maiorVendedor.getEmail();</span>
    }

   public float getMaiorVendedorValor(String nome) {
<span class="nc" id="L689">       Utilizador tmp_usr = catalogoUtilizadores.get(nome);</span>
<span class="nc" id="L690">       return tmp_usr.getTotalVendas();</span>
   }

   public float getMaiorVendedorValorPeriodo(String nome, LocalDateTime date1, LocalDateTime date2) {
<span class="nc" id="L694">       Utilizador tmp_usr = catalogoUtilizadores.get(nome);</span>
<span class="nc" id="L695">       return tmp_usr.getTotalVendasPeriodo(date1, date2);</span>
   }

   public String getMaiorTransportadora() {
<span class="nc" id="L699">       Transportadora maiorTrans = null;</span>
<span class="nc" id="L700">       float maiorValor = -1.0f;</span>

<span class="nc bnc" id="L702" title="All 2 branches missed.">       for (Transportadora t : catalogoTransportadoras.values()) {</span>
<span class="nc" id="L703">           float valor = t.getLucroEfetivo();</span>

<span class="nc bnc" id="L705" title="All 2 branches missed.">           if (valor &gt; maiorValor) {</span>
<span class="nc" id="L706">               maiorValor = valor;</span>
<span class="nc" id="L707">               maiorTrans = t;</span>
           }
<span class="nc" id="L709">       }</span>

<span class="nc" id="L711">       return maiorTrans.getNome();</span>
   }

    public float getMaiorTransportadoraValor(String nome) {
<span class="nc" id="L715">        Transportadora tmp_tra = catalogoTransportadoras.get(nome);</span>
<span class="nc" id="L716">        return tmp_tra.getLucroEfetivo();</span>
    }

    public void avancar(int hours) {
<span class="nc" id="L720">        this.currentDateTime = this.currentDateTime.plus((long) hours, ChronoUnit.HOURS);</span>
<span class="nc" id="L721">    }</span>

    public void startSimulation() {
<span class="nc bnc" id="L724" title="All 2 branches missed.">        for (Map.Entry&lt;String, Utilizador&gt; entry : catalogoUtilizadores.entrySet()) {</span>
<span class="nc" id="L725">            Utilizador tmp_usr = entry.getValue();</span>
<span class="nc" id="L726">            Map&lt;Integer, Encomenda&gt; encFeitas = tmp_usr.getEncomendasFeitas();</span>

<span class="nc bnc" id="L728" title="All 2 branches missed.">            for (Encomenda encomenda : encFeitas.values()) {</span>
<span class="nc" id="L729">                EstadoEncomenda estado = encomenda.getEstado();</span>

<span class="nc bnc" id="L731" title="All 2 branches missed.">                if (estado == EstadoEncomenda.EXPEDIDA) {</span>
<span class="nc" id="L732">                    LocalDateTime dataPrevista = encomenda.getDataPrevistaEntrega();</span>
<span class="nc bnc" id="L733" title="All 2 branches missed.">                    if (dataPrevista.isBefore(currentDateTime)) {</span>
<span class="nc" id="L734">                        encomenda.setEstado(EstadoEncomenda.FINALIZADA);</span>
<span class="nc" id="L735">                        encomenda.setDataFinalizacao();</span>

<span class="nc" id="L737">                        geraFaturaComprador(tmp_usr, encomenda);</span>
                        
<span class="nc" id="L739">                        Map&lt;Integer, Integer&gt; artigos = encomenda.getArtigos();</span>
<span class="nc bnc" id="L740" title="All 2 branches missed.">                        for (Integer codigo : artigos.keySet()) {</span>
<span class="nc" id="L741">                            Artigo artigo = artigosVendidos.get(codigo);</span>
<span class="nc" id="L742">                            String nomeVendedor = artigo.getVendedor();</span>
<span class="nc" id="L743">                            Utilizador tmp_vend = catalogoUtilizadores.get(nomeVendedor);</span>
<span class="nc" id="L744">                            geraFaturaVendedor(tmp_vend, encomenda, artigo);</span>
<span class="nc" id="L745">                        }</span>
                    }
                }
<span class="nc" id="L748">            }</span>
<span class="nc" id="L749">        }</span>
<span class="nc" id="L750">    }</span>

    public void geraFaturaVendedor(Utilizador vendedor, Encomenda encomenda, Artigo artigo) {
<span class="nc" id="L753">        Integer codigo = artigo.getCodigo();</span>
<span class="nc" id="L754">        Integer stock = encomenda.getArtigos().get(codigo);</span>
<span class="nc" id="L755">        float custo = artigo.getPrecoFinal() * stock;</span>
<span class="nc" id="L756">        Tipo tipo = Tipo.VENDA;</span>
<span class="nc" id="L757">        LocalDateTime data = encomenda.getDataFinalizacao();</span>
<span class="nc" id="L758">        List&lt;Integer&gt; artigos = new ArrayList&lt;Integer&gt;();</span>
<span class="nc" id="L759">        artigos.add(artigo.getCodigo());</span>

<span class="nc" id="L761">        Fatura fatura = new Fatura(custo, tipo, encomenda, data, artigos);</span>

<span class="nc" id="L763">        vendedor.addFatura(fatura);</span>
<span class="nc" id="L764">    }</span>

    public void geraFaturaComprador(Utilizador comprador, Encomenda encomenda) {
<span class="nc" id="L767">        float custo = encomenda.getPrecoFinal();</span>
<span class="nc" id="L768">        Tipo tipo = Tipo.COMPRA;</span>
<span class="nc" id="L769">        LocalDateTime data = encomenda.getDataFinalizacao();</span>
<span class="nc" id="L770">        List&lt;Integer&gt; artigos = new ArrayList&lt;&gt;(encomenda.getArtigos().keySet());</span>

<span class="nc" id="L772">        Fatura fatura = new Fatura(custo, tipo, encomenda, data, artigos);</span>

<span class="nc" id="L774">        comprador.addFatura(fatura);</span>
<span class="nc" id="L775">    }</span>

    public String showFaturas(String nome) {
<span class="nc" id="L778">        Utilizador tmp_usr = catalogoUtilizadores.get(nome);</span>
<span class="nc" id="L779">        List&lt;Fatura&gt; faturas = tmp_usr.getFaturas();</span>

<span class="nc" id="L781">        StringBuilder sb = new StringBuilder();</span>
<span class="nc" id="L782">        sb.append(&quot;\n&quot;);</span>
<span class="nc bnc" id="L783" title="All 2 branches missed.">        for (Fatura fatura : faturas) {</span>
<span class="nc" id="L784">           sb.append(fatura.toString());</span>
<span class="nc" id="L785">           sb.append(&quot;\n&quot;);</span>
<span class="nc" id="L786">        }</span>

<span class="nc" id="L788">        return sb.toString();</span>
    }

    public void alterarValorTransportadora(String transportadora, int option, float valor) {
<span class="nc" id="L792">        Transportadora tmp_t = catalogoTransportadoras.get(transportadora);</span>
        
<span class="nc bnc" id="L794" title="All 6 branches missed.">        switch (option) {</span>
            case 1:
<span class="nc" id="L796">                tmp_t.setValorExpEncPeq(valor);</span>
            case 2:
<span class="nc" id="L798">                tmp_t.setValorExpEncMed(valor);</span>
            case 3:
<span class="nc" id="L800">                tmp_t.setValorExpEncGra(valor);</span>
            case 4:
<span class="nc" id="L802">                tmp_t.setMargemLucro(valor);</span>
            case 5:
<span class="nc" id="L804">                tmp_t.setImposto(valor);</span>
        }
<span class="nc" id="L806">    }</span>

    public float showValorTransportadora(String transportadora, int option) {
<span class="nc" id="L809">        Transportadora tmp_t = catalogoTransportadoras.get(transportadora);</span>
<span class="nc" id="L810">        float result = 0.0f;</span>

<span class="nc bnc" id="L812" title="All 6 branches missed.">        switch (option) {</span>
            case 1:
<span class="nc" id="L814">                result = tmp_t.getValorExpEncPeq();</span>
            case 2:
<span class="nc" id="L816">                result = tmp_t.getValorExpEncMed();</span>
            case 3:
<span class="nc" id="L818">                result = tmp_t.getValorExpEncGra();</span>
            case 4:
<span class="nc" id="L820">                result = tmp_t.getMargemLucro();</span>
            case 5:
<span class="nc" id="L822">                result = tmp_t.getImposto();</span>
        }

<span class="nc" id="L825">        return result;</span>
    }

    public String showFormulaTransportadora(String transportadora) {
<span class="nc" id="L829">        Transportadora tmp_t = catalogoTransportadoras.get(transportadora);</span>
<span class="nc" id="L830">        return tmp_t.getFormula();</span>
    }

    public void alterarFormulaTransportadora(String transportadora, String formula) {
<span class="nc" id="L834">        Transportadora tmp_t = catalogoTransportadoras.get(transportadora);</span>
<span class="nc" id="L835">        tmp_t.setFormula(formula);</span>
<span class="nc" id="L836">    }</span>

    public Map&lt;String, Integer&gt; getListaMaioresVendedores(LocalDateTime date1, LocalDateTime date2) {
<span class="nc" id="L839">        Map&lt;String, Integer&gt; topVendedores = new HashMap&lt;&gt;();</span>

<span class="nc bnc" id="L841" title="All 2 branches missed.">        for (Utilizador k : catalogoUtilizadores.values()) {</span>
<span class="nc" id="L842">            topVendedores.put(k.getEmail(), k.numeroVendasEfetuadasDuranteUmPeriodoTempo(date1, date2));</span>
<span class="nc" id="L843">        }</span>

<span class="nc" id="L845">        List&lt;Map.Entry&lt;String, Integer&gt;&gt; topvendedoreslist = new ArrayList&lt;&gt;(topVendedores.entrySet());</span>
<span class="nc" id="L846">        Collections.sort(topvendedoreslist, Map.Entry.comparingByValue());</span>
<span class="nc" id="L847">        Map&lt;String, Integer&gt; topvendedoresOrdMap = new LinkedHashMap&lt;&gt;();</span>
<span class="nc bnc" id="L848" title="All 2 branches missed.">        for (Map.Entry&lt;String, Integer&gt; entry : topvendedoreslist){</span>
<span class="nc" id="L849">            topvendedoresOrdMap.put(entry.getKey(), entry.getValue());</span>
<span class="nc" id="L850">        }</span>

<span class="nc" id="L852">        return topvendedoresOrdMap;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>